var d2b=function(t,N,p,n,i,R,u,s,P,e,k,o,y,a,w,F,G,L,f){"use strict";!function(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===e&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}('@charset "UTF-8";.d2b-draggable{cursor:move}.d2b-chart-advanced{width:100%;height:100%}.d2b-pie-chart .d2b-pie-arc path{stroke-width:1px;stroke:#fff}.d2b-pie-chart .d2b-pie-arc text{fill:#fff;font-weight:700;pointer-events:none;text-anchor:middle}.d2b-axis-wrapper .d2b-axis-background{opacity:0}.d2b-chart-breadcrumbs{width:200px;padding-left:10px}.d2b-sunburst-breadcrumb .d2b-sunburst-label,.d2b-sunburst-tooltip .d2b-sunburst-label{text-align:center}.d2b-sunburst-breadcrumb .d2b-sunburst-value,.d2b-sunburst-tooltip .d2b-sunburst-value{font-size:14pt;margin-top:5px}.d2b-sunburst-breadcrumb .d2b-sunburst-percent{float:right}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-sunburst-percent{margin-left:30px}.d2b-sunburst-tooltip{text-align:center}.d2b-sunburst-tooltip .d2b-sunburst-percent{display:inline}.d2b-sunburst-tooltip .d2b-sunburst-percent:before{content:"("}.d2b-sunburst-tooltip .d2b-sunburst-percent:after{content:")"}.d2b-sankey-link-arrow{font-size:10px;position:relative;top:-2px}.d2b-line-graph .d2b-line{stroke-width:1.5px;fill:none}.d2b-area-graph .d2b-area{stroke:none;fill-opacity:.3}.d2b-box .d2b-box-center,.d2b-box .d2b-box-dash,.d2b-box .d2b-box-outlier,.d2b-box .d2b-box-rect{stroke-width:1.5px}.d2b-box .d2b-box-rect{fill:#fff;fill-opacity:.3}.d2b-box .d2b-box-center{stroke-dasharray:3 3}.d2b-box .d2b-box-label{fill:#555;font-size:10pt}.d2b-box .d2b-box-outlier{fill:none;stroke-opacity:.4}.d2b-bar-graph .d2b-bar-group rect{opacity:.8}.d2b-bubble-pack-graph .d2b-bubble-point{opacity:.75}.d2b-bubble-pack-graph .d2b-bubble-indicator rect{fill-opacity:.25;stroke-opacity:.9;cursor:pointer;stroke-width:1px}.d2b-bubble-pack-graph .d2b-bubble-indicator rect:hover{stroke-width:2px}.d2b-bubble-pack-graph .d2b-bubble-indicator path,.d2b-bubble-pack-graph .d2b-bubble-indicator text{pointer-events:none}.d2b-plane text{font-size:10pt}.d2b-plane .d2b-y2-axis .d2b-axis-label,.d2b-plane .d2b-y-axis .d2b-axis-label{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.d2b-plane .d2b-y2-axis .tick line,.d2b-plane .d2b-y-axis .tick line{stroke-width:.6px}.d2b-plane .d2b-grid .tick line{shape-rendering:crispEdges;stroke-width:.5px;stroke-opacity:.15}.d2b-plane .d2b-grid .tick text{display:none}.d2b-plane .d2b-axis-label{fill:#000;font-weight:700}.d2b-plane path.domain{stroke-width:.4px;stroke-opacity:.4}.d2b-sunburst-arc{transition:opacity .2s,stroke-width .2s;cursor:pointer;opacity:.9;stroke-width:.8px;stroke:#fff}.d2b-sunburst-arc.d2b-transparent{fill-opacity:.2}.d2b-hidden-arc{fill:none}.d2b-sunburst-label{font-size:8pt;fill-opacity:.8;pointer-events:none;font-family:arial;text-anchor:middle;dominant-baseline:middle}.d2b-sunburst-label.d2b-transparent{fill-opacity:.2}.d2b-sunburst-center{fill-opacity:0;stroke:none;cursor:pointer}.d2b-sunburst-ancestor{opacity:.4}.d2b-sankey-links path{fill:none}.d2b-sankey-links path,.d2b-sankey-links rect{opacity:.4}.d2b-sankey-links path:hover,.d2b-sankey-links rect:hover{opacity:.6}.d2b-sankey-nodes rect{stroke-width:.3px;stroke:#000;opacity:.6}.d2b-sankey-nodes rect:hover{opacity:.8}.d2b-text-anchor-end{text-anchor:end}.d2b-tooltip{pointer-events:none;background:#fff;border:1px solid #bbb;border-radius:2px;position:fixed;box-shadow:0 0 2px #ccc;margin:0}.d2b-tooltip:before{left:0;top:0;position:absolute;z-index:2;content:""}.d2b-tooltip-content{white-space:nowrap;padding:6px 10px}.d2b-tooltip-top{-webkit-transform:translate(-50%,-100%);transform:translate(-50%,-100%);margin-left:0;margin-top:-15px}.d2b-tooltip-top:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:100%;border-color:transparent;border-style:solid;border-width:6px 7px 0;border-top-color:inherit}.d2b-tooltip-bottom{-webkit-transform:translate(-50%);transform:translate(-50%);margin-left:0;margin-top:15px}.d2b-tooltip-bottom:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:-6px;border-color:transparent;border-style:solid;border-width:0 7px 6px;border-bottom-color:inherit}.d2b-tooltip-right{margin-left:15px;margin-top:0}.d2b-tooltip-right,.d2b-tooltip-right:before{-webkit-transform:translateY(-50%);transform:translateY(-50%)}.d2b-tooltip-right:before{left:-6px;top:50%;border-color:transparent;border-style:solid;border-width:7px 6px 7px 0;border-right-color:inherit}.d2b-tooltip-left{-webkit-transform:translate(-100%,-50%);transform:translate(-100%,-50%);margin-left:-15px;margin-top:0}.d2b-tooltip-left:before{-webkit-transform:translateY(-50%);transform:translateY(-50%);left:100%;top:50%;border-color:transparent;border-style:solid;border-width:7px 0 7px 6px;border-left-color:inherit}.d2b-tooltip-marker{stroke-width:2px;stroke:#bbb;stroke-dasharray:5,5}.d2b-tooltip-axis{pointer-events:none;font-family:Arial;opacity:.9;white-space:nowrap;border:1px solid #ddd;background:hsla(0,0%,100%,.8);position:absolute;box-shadow:0 0 2px #ccc}.d2b-tooltip-axis .d2b-tooltip-title{text-align:center;background:rgba(150,165,175,.8);padding:5px 10px;font-weight:700;color:#fff}.d2b-tooltip-axis .d2b-tooltip-content{padding:5px 10px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row{padding-left:5px;border-left-width:3px;border-left-style:solid;margin-bottom:5px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row:last-child{margin-bottom:0}.d2b-breadcrumbs{color:#555;font-size:9pt;box-sizing:content-box}.d2b-breadcrumbs .d2b-breadcrumb{border-color:transparent;border-style:solid;border-width:0 0 1px 8px;padding:6px 13px;margin-bottom:10px;text-transform:uppercase;position:relative}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after,.d2b-breadcrumbs .d2b-breadcrumb:last-child .d2b-breadcrumb-icon:after{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-15.5px;width:13px;height:13px;text-align:center;font-family:FontAwesome,Font Awesome\\ 5 Free;font-weight:700;color:#fff;background-color:inherit;padding:5px;border-radius:15px}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after{content:""}.d2b-breadcrumbs .d2b-breadcrumb:not(:first-child):last-child .d2b-breadcrumb-icon:after{content:""}.d2b-breadcrumbs:not(.d2b-vertical){white-space:nowrap}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb{border-right-width:1px;border-top-width:1px;white-space:nowrap;display:inline-block}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child){margin-right:20px}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child):after{border-color:transparent;border-style:solid;border-width:7px 0 7px 6px;border-left-color:inherit;position:absolute;z-index:2;content:"";top:50%;left:100%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.d2b-breadcrumbs.d2b-vertical .d2b-breadcrumb:not(:last-child):after{border-color:transparent;border-style:solid;border-width:6px 7px 0;border-top-color:inherit;height:6px;background-color:inherit;position:absolute;z-index:2;content:"";top:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.d2b-legend{color:#555;font-size:9pt}.d2b-legend .d2b-legend-item{border:0 solid transparent;padding:2px 2px 2px 18px;position:relative;cursor:pointer}.d2b-legend .d2b-legend-item .d2b-legend-icon{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:7px;width:12px;height:12px}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon{margin-left:-5px;margin-top:-5px;pointer-events:none}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon path,.d2b-legend .d2b-legend-item .d2b-legend-svg-icon text{font-family:FontAwesome,Font Awesome\\ 5 Free;font-weight:700;text-anchor:middle;stroke-width:1px;fill-opacity:.8}.d2b-legend:not(.d2b-vertical) .d2b-legend-item{display:inline-block}.d2b-legend:not(.d2b-vertical) .d2b-legend-item:not(:last-child){margin-right:10px}.d2b-legend:not(.d2b-vertical) .d2b-legend-icon{margin-top:1.5px}.d2b-chart-frame{height:100%;width:100%;position:relative}.d2b-chart-frame .d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-chart,.d2b-chart-frame .d2b-legend-frame{position:absolute;overflow:auto}.d2b-chart-frame .d2b-breadcrumbs-frame .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame .d2b-breadcrumbs{padding-left:10px;padding-right:2px}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical),.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical){overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-legend-frame{height:20px;text-align:center}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-breadcrumbs-frame{height:55px}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend-item,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend-item{white-space:nowrap;overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-breadcrumbs-frame{width:180px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-legend-frame{width:110px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container{display:table;height:100%;width:100%}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-legend{display:table-cell;vertical-align:middle}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs{display:table-cell;vertical-align:top}');function x(t){return"function"==typeof t?t:function(){return t}}function I(){for(var t=function(t){return null!=t&&!1!==t},n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];var a=e.filter(t)[0];return t(a)?a:void 0}function O(t){var h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(t){return t.label},y=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0,g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"start";h=x(h),y=x(y),g=x(g),t.each(function(t,n){var e,r=N.select(this),a="".concat(h.call(this,t,n)).split(/\s+/).reverse(),o=[],i=[a.pop()],c=y.call(this,t,n),l=g.call(this,t,n),d=+r.attr("x"),u=+r.attr("y"),s=parseFloat(r.attr("dy"))||0;for(-1===I(r.html(),"").indexOf("tspan")&&r.text(""),e=a.pop();e;)i.join(" ").length+e.length>c&&(o.push(i),i=[]),i.push(e),e=a.pop();o.push(i);var p=r.selectAll("tspan").data(o),f=1.1*(o.length-1),b="end"===l?f:"middle"===l?f/2:0;p.merge(p.enter().append("tspan")).text(function(t){return t.join(" ")}).attr("x",d).attr("y",u).attr("dy",function(t,n){return"".concat(s+1.1*n-b,"em")})})}function A(t,r){function a(t){return{innerRadius:r.innerRadius()(t),outerRadius:r.outerRadius()(t),startAngle:r.startAngle()(t),endAngle:r.endAngle()(t),cornerRadius:r.cornerRadius()(t),padAngle:r.padAngle()(t)}}if((!(2<arguments.length&&void 0!==arguments[2])||arguments[2])&&["cornerRadius","innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle"].forEach(function(n){var e=r[n]();if(e&&!e.reformed){var t=function(t){return t[n]||e(t)};t.reformed=!0,r[n](t)}}),!t.selection)return t.attr("d",function(t){return this.current=a(t),r(t)});t.attrTween("d",function(t){var n=this;t=a(t),this.current=this.current||t;var e=p.interpolate(this.current,t);return function(t){return n.current=e(t),r(n.current)}})}function c(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return isNaN(t)||null===t?n:t}function m(t){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(t){return t},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t){return t};if(o=x(o),!t.selection)return t.text(function(t,n){return this.current=c(o.call(this,t,n)),i(this.current)});t.tween("text",function(t,n){var e=this,r=c(o.call(this,t,n));this.current=c(this.current,r);var a=p.interpolate(this.current,r);return function(t){e.textContent=i(e.current=a(t))}})}function _(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t){return t.rotate};function a(t){return{innerRadius:r.innerRadius()(t),outerRadius:r.outerRadius()(t),startAngle:r.startAngle()(t),endAngle:r.endAngle()(t),rotate:n(t)||0}}if(n=x(n),!t.selection)return t.attr("transform",function(t){return this.current=a(t),"translate(".concat(r.centroid(this.current),")")+"rotate(".concat(this.current.rotate,")")});t.attrTween("transform",function(t){var n=this;t=a(t),this.current=this.current||t;var e=p.interpolate(this.current,t);return function(t){return n.current=e(t),"translate(".concat(r.centroid(n.current),") ")+"rotate(".concat(n.current.rotate||0,")")}})}function T(){var r=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=function(e,r){return function(t){if(!arguments.length)return a[e];var n=a[e];return a[e]=t,r&&r(t,n),c}},l=function(e,r){return function(t){if(!arguments.length)return a[e];var n=a[e];return a[e]=x(t),r&&r(a[e],n),c}};c.conditionally=function(t,n){for(var e=arguments.length,r=new Array(2<e?e-2:0),a=2;a<e;a++)r[a-2]=arguments[a];return r.length?(n||0===n)&&c[t].apply(null,r):void 0!==n&&c[t](n),c};var d=function(a){a.conditionally=function(t){for(var n=arguments.length,e=new Array(1<n?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return e.length?(t||0===t)&&a.apply(null,e):void 0!==t&&a(t),c}},u={base:function(){return c},values:function(){return a},removeProp:function(t){return a[t]=null,c[t]=null,u},addProp:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:o(t),r=3<arguments.length?arguments[3]:void 0;return a[t]||c[t]||((e=e||o(t,r))(n),c[t]=e,d(c[t])),u},addPropGet:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t){return function(){return a[t]}}(t);return a[t]||c[t]||(a[t]=n,c[t]=e,d(c[t])),u},addMethod:function(t,n){return c[t]||(c[t]=n,d(c[t])),u},addPropFunctor:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:l(t),r=3<arguments.length?arguments[3]:void 0;if(a[t]||c[t])return u;(e=e||l(t,r))(n);var i=c[t]=e;return d(c[t]),i.proxy=function(a){var t=i(),o=t.original||t,n=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=a.apply(this,n);return void 0===r?o.apply(this,n):r};return n.original=o,i(n),c},u},addScaleFunctor:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(e,r){return function(t){if(!arguments.length)return a[e];var n=a[e];return t&&t.domain?a[e]=function(){return t}:a[e]=x(t),r&&r(a[e],n),c}}(t),r=3<arguments.length?arguments[3]:void 0;return u.addProp(t,n,e,r)},addDispatcher:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"on",e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"dispatch";return c[n]||a[e]||(c[n]=function(t,n){return 0===arguments.length?a[e]:1===arguments.length?a[e].on(t):(a[e].on(t,n),c)},d(c[n]),a[e]=i.dispatch.apply(r,t)),u},addAdvancedConfig:function(a){return c.advanced=function(e){var t=e.selection?e.selection():e,r=t!==e;return t.each(function(t){void 0!==t.updated&&N.select(this).on("chart-updated.advanced",t.updated);var n=N.select(this).selectAll(".d2b-chart-advanced").data([a(c,t)]);n=n.enter().append("div").attr("class","d2b-chart-advanced").merge(n),(r?n.transition(e):n).call(c)}),c},u}};return u}var l=function(){return"ontouchstart"in window||window.navigator.msPointerEnabled};function b(){var d={},n=function t(n){var e=n.selection?n.selection():n;return e.on(i("mouseover"),r).on(i("mouseout"),o),l()?e.on(i("click"),o):e.on(i("mousemove"),a),t},r=function(t,n){if(d.html.call(this,t,n)){var e=d.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),r=e.enter().append("div").style("opacity",0).attr("class","d2b-tooltip");r.append("div").attr("class","d2b-tooltip-content"),(e=e.merge(r)).transition().duration(100).style("opacity",1),d.dispatch.call("insert",e,this,t,n),a.call(this,t,n)}},a=function(t,n){var e=d.html.call(this,t,n),r=d.target.call(this,t,n),a=d.color.call(this,t,n),o=r?r.node():this,i=d.followMouse.call(this,t,n)?{x:N.event.clientX,y:N.event.clientY}:function(t,n){var e=this.getBoundingClientRect(),r={},a=(d.at.call(this,t,n)||(N.event.clientX>window.innerWidth/2?"center left":"center right")).split(" ");switch((a={x:a[1],y:a[0]}).x){case"left":r.x=e.left;break;case"center":r.x=e.left+e.width/2;break;default:r.x=e.left+e.width}switch(a.y){case"bottom":r.y=e.top+e.height;break;case"center":r.y=e.top+e.height/2;break;default:r.y=e.top}return r}.call(o,t,n);if(e){var c=d.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),l=d.my.call(this,t,n)||(N.event.clientX>window.innerWidth/2?"left":"right");c.attr("class","d2b-tooltip d2b-tooltip-".concat(l)).style("top",i.y+"px").style("left",i.x+"px").style("border-color",a).select(".d2b-tooltip-content").html(e),d.dispatch.call("move",c,this,t,n)}},o=function(t,n){var e=d.container.selectAll(".d2b-tooltip").data(function(t){return[t]});e.transition().duration(100).style("opacity",0).remove(),d.dispatch.call("remove",e,this,t,n)},i=function(t){return"".concat(t,".d2b-tooltip")};return T(n,d).addProp("container",N.select("body")).addMethod("clear",function(t){return(t.selection?t.selection():t).on(i("mouseover"),null).on(i("mouseout"),null).on(i("mousemove"),null),n}).addPropFunctor("followMouse",!1).addPropFunctor("color",null).addPropFunctor("my",null).addPropFunctor("at",null).addPropFunctor("target",null).addPropFunctor("html",null).addDispatcher(["insert","move","remove"]),n}function v(){for(var t=function(t){return void 0!==t},n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];var a=e.filter(t)[0];return t(a)?a:void 0}function Q(){var y={},l={},a=function(t,n,e){if("y"===e){if(n.y===1/0)return t.style("opacity",0);t.style("opacity",1).attr("transform","translate(0, ".concat(n.y,")")).attr("y1",0).attr("y2",0).attr("x1",0).attr("x2",y.size.width)}else{if(n.x===1/0)return t.style("opacity",0);t.style("opacity",1).attr("transform","translate(".concat(n.x,", 0)")).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",y.size.height)}},o=function(t,n,e){if(t.node()){var r=t.node().getBoundingClientRect(),a=e.x,o=e.y;y.trackY?n.y>y.size.height/2?o+=n.y-10-r.height:o+=n.y+10:o=N.event.clientY-e.y>y.size.height/2?N.event.clientY-10-r.height:N.event.clientY+10,y.trackX?n.x>y.size.width/2?a+=n.x-10-r.width:a+=n.x+10:a=N.event.clientX-e.x>y.size.width/2?N.event.clientX-10-r.width:N.event.clientX+10,a+=window.pageXOffset,o+=window.pageYOffset,t.style("left",a+"px").style("top",o+"px")}},i=function(t,n){var e=y.title(n.points.map(function(t){return t.data}));t.select(".d2b-tooltip-title").style("display",e?"block":"none").html(e);var r=t.select(".d2b-tooltip-content").selectAll(".d2b-tooltip-row").data(n.points),a=r.enter().append("div").attr("class","d2b-tooltip-row");r.exit().remove(),r=r.merge(a).html(function(t){return t.row}).style("border-left-color",function(t){return t.color||"transparent"})},t=function(t){t.transition().duration(50).style("opacity",0).remove()},d=function(t){t.transition().duration(50).style("opacity",1)},c=function(){y.svgContainer.selectAll(".d2b-tooltip-marker-x").data([]).exit().call(t),y.svgContainer.selectAll(".d2b-tooltip-marker-y").data([]).exit().call(t),y.htmlContainer.selectAll(".d2b-tooltip-axis").data([]).exit().call(t)},e=function(t,n){y.svgContainer.selectAll(".d2b-tooltip-base").data([t]).enter().append("rect").attr("class","d2b-tooltip-base");var e=y.svgContainer.node().getBoundingClientRect(),r=function(t){var s=N.event.clientX-t.x,p=N.event.clientY-t.y,f=1/0,b=1/0,h=[];for(var n in g)if(g.hasOwnProperty(n)){var e=g[n],r=function(t){if(!e.hasOwnProperty(t))return"continue";var d=e[t],u=[];d.config.data.forEach(function(t,n){var e={data:t,x:I(d.config.x(t,n),y.x(t,n)),y:I(d.config.y(t,n),y.y(t,n)),color:I(d.config.color(t,n),y.color(t,n)),row:v(d.config.row(t,n),y.row(t,n))};if(y.trackX&&y.trackY){if(e.x===f&&e.y===b)return u.push(e);var r=Math.sqrt(Math.pow(f-s,2)+Math.pow(b-p,2)),a=Math.sqrt(Math.pow(e.x-s,2)+Math.pow(e.y-p,2));a<r&&a<y.threshold&&(f=e.x,b=e.y,h=[],u=[e])}else if(y.trackX){if(e.x===f)return u.push(e);var o=Math.abs(f-s),i=Math.abs(e.x-s);i<o&&i<y.threshold&&(f=e.x,h=[],u=[e])}else if(y.trackY){if(e.y===b)return u.push(e);var c=Math.abs(b-p),l=Math.abs(e.y-p);l<c&&l<y.threshold&&(b=e.y,h=[],u=[e])}}),h=h.concat(u)};for(var a in e)r(a)}return h=h.sort(function(t,n){return R.ascending(t.x,n.x)||R.ascending(t.y,n.y)}),{x:f,y:b,points:h}}(e={x:e.left,y:e.top});if(!r.points.length)return c();!function(t,n){var e=y.svgContainer.selectAll(".d2b-tooltip-marker-x").data(y.trackX?[l]:[]),r=e.enter().append("line").attr("class","d2b-tooltip-marker-x d2b-tooltip-marker"),a=y.svgContainer.selectAll(".d2b-tooltip-marker-y").data(y.trackY?[l]:[]),o=a.enter().append("line").attr("class","d2b-tooltip-marker-y d2b-tooltip-marker"),i=y.htmlContainer.selectAll(".d2b-tooltip-axis").data([l]),c=i.enter().append("div").attr("class","d2b-tooltip d2b-tooltip-axis");c.merge(i).call(d),a.merge(o).call(d),e.merge(r).call(d),c.append("div").attr("class","d2b-tooltip-title"),c.append("div").attr("class","d2b-tooltip-content"),y.dispatch.call("insert",y.tooltip,t,n)}(),y.svgContainer.select(".d2b-tooltip-marker-x").call(a,r,"x"),y.svgContainer.select(".d2b-tooltip-marker-y").call(a,r,"y"),y.htmlContainer.select(".d2b-tooltip-axis").call(i,r).call(o,r,e),y.dispatch.call("move",y.tooltip,t,n)},r=function(t,n){c(),y.dispatch.call("remove",y.tooltip,t,n)},u=function(t){return"".concat(t,".d2b-tooltip-axis")};T(l,y).addProp("htmlContainer",N.select("body")).addProp("svgContainer",null).addProp("tracker",N.select("body"),null,function(t,n){n&&n.on(u("mouseout"),null).on(u("mousemove"),null),t&&t.on(u("mouseout"),r).on(u("mousemove"),e)}).addProp("size",{height:0,width:0}).addProp("trackX",!0).addProp("trackY",!1).addProp("threshold",1/0).addMethod("clear",function(t,n){return 0===arguments.length?g={}:1===arguments.length?delete g[t]:2<=arguments.length&&delete g[t][n],l}).addPropFunctor("title",null).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("color",null).addPropFunctor("row",null).addDispatcher(["move","insert","remove"]);var g={};return l.graph=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=g[t]=g[t]||{},r=e[n];r||T((r=e[n]={interface:{},config:{}}).interface,r.config).addProp("data",[]).addMethod("clear",function(){return r.config.data=[],r.interface}).addMethod("addPoint",function(t){return r.config.data.push(t),r.interface}).addPropFunctor("x",null).addPropFunctor("y",null).addPropFunctor("color",null).addPropFunctor("row",function(){});return r.interface},l}function d(){var d={},t=function(t){var o=this,n=t;t=t.map(d.values);var a=[],e=t.map(function(t){var r={};return t.forEach(function(t,n){var e=d.x.call(o,t,n);a.push(e),r[e]=d.y.call(o,t,n)}),r}),i=(a=u.set(a).values()).reduce(function(t,n,e){return t[n]=e,t},{}),r=R.range(0,t.length),c=a.map(function(n){return e.map(function(t){return t[n]||0})});d.stack.keys(r).value(function(t,n){return t[n]||0});var l=d.stack(c);return t.forEach(function(t,a){t.forEach(function(t,n){var e=d.x.call(o,t,n),r=l[a][i[e]];d.out.call(o,t,r[0],r[1],e)})}),n};return T(t,d).addProp("stack",s.stack()).addPropFunctor("values",function(t){return t}).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addProp("out",function(t,n,e){t.y0=n,t.y1=e}),t}function h(){var l={},t=function t(n){var e=n.selection?n.selection():n,r=e.selectAll(".d2b-breadcrumbs").data(function(t){return[t]}),a=r.enter().append("div").attr("class","d2b-breadcrumbs"),o=(r=r.merge(a).classed("d2b-vertical",l.vertical)).selectAll(".d2b-breadcrumb").data(function(t){return l.values(t).filter(l.html)},l.key),i=o.exit(),c=o.enter().append("div").attr("class","d2b-breadcrumb").style("opacity",0);return c.append("div").attr("class","d2b-breadcrumb-icon"),c.append("div").attr("class","d2b-breadcrumb-content"),(o=o.merge(c).order()).select(".d2b-breadcrumb-content").html(l.html),n!==e&&(o=o.transition(n),i=i.transition(n).style("opacity",0)),o.style("border-color",l.color).style("opacity",1).select(".d2b-breadcrumb-icon").style("background-color",l.color),i.remove(),e.dispatch("breadcrumbs-updated",{bubbles:!0}),t};return T(t,l).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,n){return n}).addPropFunctor("color","blue").addPropFunctor("html",function(t){return t.html}).addPropFunctor("vertical",!0),t}var j=P.scaleOrdinal(e.schemeCategory10);function W(){var v={},m=s.symbol().size(80),t=function c(g){var x=g.selection?g.selection():g,t=x.selectAll(".d2b-legend").data(function(t){return[t]}),n=t.enter().append("div").attr("class","d2b-legend"),e=(t=t.merge(n).classed("d2b-vertical",v.vertical)).selectAll(".d2b-legend-item").data(v.values,v.key),r=e.exit(),a=e.enter().append("div").attr("class","d2b-legend-item").style("opacity",0);a.append("div").attr("class","d2b-legend-icon"),a.append("div").attr("class","d2b-legend-content"),(e=e.merge(a).order()).select(".d2b-legend-content").html(v.html),g!==x&&(e=e.transition(g),r=r.transition(g).style("opacity",0)),e.style("opacity",1).each(function(t,n){var e=N.select(this),r=v.color(t,n),a=v.empty(t,n),o=v.icon(t,n),i=e.select(".d2b-legend-icon"),c=[],l=[],d=i.node().getBoundingClientRect(),u={width:d.width,height:d.height},s={x:u.width/2,y:u.height/2};"string"==typeof o?c.push(o):l.push(o);var p=i.selectAll(".d2b-legend-svg-icon").data(function(t){return[t]}),f=p.enter().append("svg");f.attr("class","d2b-legend-svg-icon").attr("width",u.width).attr("height",u.height);var b=(p=p.merge(f)).selectAll("text").data(c),h=b.enter().append("text");b.exit().remove(),h.append("tspan"),(b=b.merge(h)).select("tspan").text(function(t){return t});var y=p.selectAll("path").data(l);y.exit().remove(),(y=y.merge(y.enter().append("path"))).attr("d",function(t){return m.type(t)()}),g!==x&&(e=e.transition(g),b=b.transition(g),y=y.transition(g)),e.style("border-color",r),b.style("stroke",r).style("fill",a?"white":r).attr("transform","translate(".concat(s.x,",").concat(1.65*s.y,")")),y.style("stroke",r).style("fill",a?"white":r).attr("transform","translate(".concat(s.x,",").concat(s.y,")"))}),t.each(function(t,n){var e=v.allowEmptied(t,n),r=N.select(this).selectAll(".d2b-legend-item"),a=function(e){r.each(function(t,n){v.setEmpty(t,n,e)})},o=function(t,n){v.setEmpty(t,n,!v.empty(t,n)),!e&&function(){var e=!0;return r.each(function(t,n){v.empty(t,n)||(e=!1)}),e}()&&a(!1),x.call(c),N.select(this.parentNode).dispatch("change",{bubbles:!0})},i=function(t,n){a(!0),v.setEmpty(t,n,!1),x.call(c),N.select(this.parentNode).dispatch("change",{bubbles:!0})};r.each(function(t,n){var e=v.clickable(t,n),r=v.dblclickable(t,n);N.select(this).on("click",e?o:null).on("dblclick",r?i:null)})}),x.dispatch("legend-updated",{bubbles:!0}),r.remove()};return T(t,v).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,n){return n}).addPropFunctor("color",function(t){return j(t.html)}).addPropFunctor("html",function(t){return t.html}).addPropFunctor("icon",s.symbolCircle).addPropFunctor("vertical",!1).addPropFunctor("allowEmptied",!1).addPropFunctor("clickable",!1).addPropFunctor("dblclickable",!1).addPropFunctor("empty",function(t){return t.empty}).addPropFunctor("setEmpty",function(t,n,e){return t.empty=e}),t}function M(){function v(n){var t={top:0,left:0,right:0,bottom:0};return"number"==typeof n?{top:n,left:n,right:n,bottom:n}:(["top","bottm","right","left"].forEach(function(t){n[t]&&n[t]}),t)}var m={},t=function t(g){var x=g.selection?g.selection():g,n=x.selectAll(".d2b-chart-frame").data(function(t){return[t]}),e=n.enter().append("div").attr("class","d2b-chart-frame");return n=n.merge(e),x.each(function(t){var n=N.select(this).select(".d2b-chart-frame"),e=n,r=v(m.padding(t)),a=v(m.chartPadding(t)),o=function(t,n){return{width:t&&0<t.width?t.width:n.width,height:t&&0<t.height?t.height:n.height}}(m.size(t),this.getBoundingClientRect()),i=m.legendEnabled(t)?[t]:[],c=n.selectAll(".d2b-legend-frame").data(i),l=c.enter().append("div").attr("class","d2b-legend-frame");c.exit().remove(),l.append("div").attr("class","d2b-legend-container");var d=c=c.merge(l),u=m.breadcrumbsEnabled(t)?[t]:[],s=n.selectAll(".d2b-breadcrumbs-frame").data(u),p=s.enter().append("div").attr("class","d2b-breadcrumbs-frame");s.exit().remove(),p.append("div").attr("class","d2b-breadcrumbs-container");var f=s=s.merge(p),b=n.selectAll(".d2b-chart").data(function(t){return[t]}),h=b.enter().append("svg").attr("class","d2b-chart");h.append("g").attr("class","d2b-chart-container");var y=b=b.merge(h);g!==x&&(e=e.transition(g),d=d.transition(g),f=f.transition(g),y=y.transition(g)),e.style("width",o.width+"px").style("height",o.height+"px"),o.width-=r.left+r.right,o.height-=r.top+r.bottom,P(s,p,f,m.breadcrumbsOrient(t),r,o),P(c,l,d,m.legendOrient(t),r,o),k(h,y,function(t){t.style("left",r.left+"px").style("top",r.top+"px").style("width",o.width+"px").style("height",o.height+"px"),t.select(".d2b-chart-container").attr("transform","translate("+[a.left,a.top]+")")}),o.width-=a.left+a.right,o.height-=a.top+a.bottom,b.select(".d2b-chart-container").node().__size__=o}),x.dispatch("chart-frame-updated",{bubbles:!0}),t};function k(t,n,e){e(t),e(n)}function P(t,n,e,r,a,o){var i,c=t.node();c&&(e.style("top","").style("left","").style("right","").style("bottom","").style("width","").style("height",""),"right"===r||"left"===r?(t.classed("d2b-vertical",!0),i=c.getBoundingClientRect(),k(n,e,function(t){t.style(r,a[r]+"px").style("top",a.top+"px").style("height",o.height+"px")}),a[r]+=i.width,o.width-=i.width):"top"===r||"bottom"===r?(t.classed("d2b-vertical",!1),i=c.getBoundingClientRect(),k(n,e,function(t){t.style(r,a[r]+"px").style("left",a.left+"px").style("width",o.width+"px")}),a[r]+=i.height,o.height-=i.height):t.classed("d2b-vertical",!1))}return T(t,m).addPropFunctor("size",null).addPropFunctor("legendEnabled",!0).addPropFunctor("legendOrient","bottom").addPropFunctor("breadcrumbsEnabled",!1).addPropFunctor("breadcrumbsOrient","right").addPropFunctor("chartPadding",10).addPropFunctor("padding",10),t}var D=function(){return Math.random().toString(36).substr(2,9)};var g=function(t){return null===t?NaN:+t};function z(t,r,a){var o=0,i=0;if(a=x(a||1),r=x(r||function(t){return t}),t.filter(function(t){return!isNaN(g(a(t)))&&!isNaN(g(r(t)))}).forEach(function(t){var n=a(t),e=r(t);o+=n,i+=e*n}),t.length&&o)return i/o}function r(t,e,n){n=x(n||1),e=x(e||function(t){return t});var r,a=[],o=t.filter(function(t){return 0!==n(t)&&!isNaN(g(n(t)))&&!isNaN(g(e(t)))}).sort(function(t,n){return R.ascending(e(t),e(n))});r=Math.round(R.sum(o,function(t){return n(t)})/2*1e12)/1e12;var i=0,c=!1;if(o.forEach(function(t){c&&(a.push(e(t)),c=!1),(i+=n(t))===r&&(a.push(e(t)),c=!0),r<i&&0===a.length&&a.push(e(t))}),t.length)return z(a)}function E(t,e,r){r=x(r||1),e=x(e||function(t){return t});var a=[],o=0,i={};return t.forEach(function(t){var n=g(e(t));isNaN(e(t))||(i[n]=i[n]||0,i[n]+=r(t),i[n]>o?(o=i[e(t)],a=[e(t)]):i[e(t)]==o&&a.push(e(t)))}),o<=1||!a.length?null:1===a.length?a[0]:a}function C(t,n){n=x(n||function(t){return t});var e=R.extent(t,n);if(t.length)return e[1]-e[0]}function B(t,n){if(n=x(n||function(t){return t}),t.length)return R.mean(R.extent(t,n))}function Y(t){return t*(180/Math.PI)}z.tendancy="mean",r.tendancy="median",E.tendancy="mode",C.tendancy="range",B.tendancy="midpoint";var X=Math.PI,S=Math.sqrt(8),U=Math.sqrt(2),K={draw:function(t,n){var e=Math.sqrt(n/(X+5/4)),r=.3125*e,a=2*Math.asin(.25),o=(X/2-a)/2,i=e/S-e*Math.cos(o),c=e*Math.sin(o);t.arc(i,c,e,-o,2*X-a-o),t.lineTo(e*(5/4-1/U),-e*(1/S+5/4-1/U)),t.lineTo(e*(5/4-1/U)-r,-e*(1/S+5/4-1/U)),t.lineTo(e*(5/4-1/U)-r,-e*(1/S+7/4-1/U)),t.lineTo(e*(7/4-1/U+1/S),-e*(1/S+7/4-1/U)),t.lineTo(e*(7/4-1/U+1/S),-e*(5/4-1/U)+r),t.lineTo(e*(5/4-1/U+1/S),-e*(5/4-1/U)+r),t.lineTo(e*(5/4-1/U+1/S),-e*(5/4-1/U)),t.closePath()}},V={draw:function(t,n){var e=Math.sqrt(n/(X+5/4)),r=2*Math.asin(.25),a=e/4-e*Math.cos(r/2);t.arc(0,a,e,3*-X/2+r/2,X/2-r/2),t.lineTo(e/4,3*e/4),t.lineTo(3*e/4,3*e/4),t.lineTo(3*e/4,5*e/4),t.lineTo(e/4,5*e/4),t.lineTo(e/4,7*e/4),t.lineTo(-e/4,7*e/4),t.lineTo(-e/4,5*e/4),t.lineTo(3*-e/4,5*e/4),t.lineTo(3*-e/4,3*e/4),t.lineTo(-e/4,3*e/4),t.closePath()}};function q(){var o={},t=function t(n){var e=n.selection?n.selection():n,r=e.selectAll("path.d2b-point-back").data(function(t){return[t]});r.enter().append("path").attr("class","d2b-point-back").attr("d",l).style("fill-opacity",0).style("stroke",o.stroke).style("stroke-width",o.strokeWidth),n!==e&&(r=r.transition(n)),r.attr("d",l).style("stroke",o.stroke).style("stroke-width",o.strokeWidth);var a=e.selectAll("path.d2b-point-front").data(function(t){return[t]});return a.enter().append("path").attr("class","d2b-point-front").attr("d",c).style("opacity",i).style("fill",o.fill).style("stroke",o.stroke).style("stroke-width",o.strokeWidth),n!==e&&(a=a.transition(n)),a.attr("d",c).style("opacity",i).style("fill",o.fill).style("stroke",o.stroke).style("stroke-width",o.strokeWidth),e.each(function(t,n){var e=o.active.call(this,t,n);N.select(this).on("mouseover.d2b-point",e?d:null).on("mouseout.d2b-point",e?u:null)}),e.dispatch("point-updated",{bubbles:!0}),t},a=s.symbol();function i(t,n){return o.empty.call(this,t,n)?0:1}function r(t,n){var e=o.size.call(this,t,n),r=o.empty.call(this,t,n);return a.size(r?e:2.5*e).call(this,t,n)}function c(t,n){var e=o.size.call(this,t,n),r=o.empty.call(this,t,n);return a.size(r?e/3:e).call(this,t,n)}function l(t,n){var e=o.size.call(this,t,n);return a.size(e).call(this,t,n)}function d(t,n){var e=o.empty.call(this,t,n);N.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",r),N.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",e?.5:1).attr("d",c)}function u(t,n){var e=o.empty.call(this,t,n);N.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",l),N.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",e?0:1).attr("d",c)}return T(t,o).addPropFunctor("size",150,null,function(t){return a.size(t)}).addPropFunctor("type",s.symbolCircle,null,function(t){return a.type(t)}).addPropFunctor("active",!1).addPropFunctor("empty",!1).addPropFunctor("fill","steelblue").addPropFunctor("stroke",function(t,n){return k.rgb(o.fill.call(this,t,n)).darker(.3)}).addPropFunctor("strokeWidth","1px"),t}function Z(){var d={},t=function t(c){var l=c.selection?c.selection():c;d.pie.value(d.value),d.arc.startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}).padAngle(function(t){return t.padAngle});var n=l.selectAll(".d2b-pie").data(function(t){return[d.pie(d.values(t))]}),e=n.enter().append("g").attr("class","d2b-pie");return(n=n.merge(e)).each(function(t){var n=N.select(this).selectAll(".d2b-pie-arc"),r=n.data(),e=(n=n.data(t,function(t,n){return t.key=d.key(t.data,n),t.key})).enter().append("g").attr("class","d2b-pie-arc"),a=n.exit(),o=n.merge(e).order();e.append("path").attr("fill",function(t,n){return d.color.call(this,t.data,n)});var i=o.data();e.select("path").each(function(t,n){this.current=u(n,r,i)}),a.datum(function(t,n){var e=u(n,i,r);return e.data=t.data,e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e}),c!==l&&(a=a.transition(c),o=o.transition(c)),o.select("path").call(A,d.arc).attr("fill",function(t,n){return d.color.call(this,t.data,n)}),a.remove().select("path").call(A,d.arc)}),l.dispatch("svg-pie-updated",{bubbles:!0}),t};function u(t,n,e){var r=function(t,n,e){var r=n.length;for(;0<=--t;)for(var a=d.key(e[t].data,t),o=0;o<r;++o)if(d.key(n[o].data,o)===a)return n[o]}(t,n,e),a=function(t,n,e){var r=e.length,a=n.length;for(;++t<r;)for(var o=d.key(e[t].data,t),i=0;i<a;++i)if(d.key(n[i].data,i)===o)return n[i]}(t,n,e);return r?{startAngle:r.endAngle,endAngle:r.endAngle}:a?{startAngle:a.startAngle,endAngle:a.startAngle}:{startAngle:0,endAngle:0}}return T(t,d).addProp("arc",s.arc()).addProp("pie",s.pie().sort(null)).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t){return t.label}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("color",function(t){return j(t.label)}),t}function H(t){return!(-1<t.indexOf("NaN")||-1<t.indexOf("Inifnity"))}function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var $=function(t){return o.annotation().disable(t.disable()).textWrap(t.textWrap()).notePadding(t.notePadding()).type(t.type()).accessors(t.accessors()).accessorsInverse(t.accessorsInverse()).ids(t.ids()).editMode(t.editMode()).collection(t.collection())},tt=function(c,l,d){var u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(t){return t.annotation?[t.annotation]:[]},s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:function(t){return t.color},p=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"translate(0, 0)",f=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"translate(0, 0)",b=c.selection?c.selection():c;c.each(function(n){var t=N.select(this),e=x(u)(n),r=t.selectAll("g."+d).data(e),a=r.enter().append("g"),o=r.merge(a),i=r.exit();a.attr("class",d).attr("transform",function(t){return x(f)(n,t)}).style("opacity",0),e.forEach(function(t){t.x=0,t.y=0,t.color=x(s)(n,t)}),e.length&&l&&(o.selectAll("*").remove(),o.call($(l).annotations(e))),c!==b&&(o=o.transition(c),i=i.transition(c)),o.attr("transform",function(t){return x(p)(n,t)}).style("opacity",1),i.attr("transform",function(t){return x(p)(n,t)}).style("opacity",0).remove()})};function nt(t){if(null==t||"object"!=J(t))return t;var n=t.constructor();for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}var et=function(t,n,e,c){var l=t.selection?t.selection():t,r=l.node(),a=r.__scales||c,o=function(t,n){var e=n[t.xType],r=n[t.yType],a=t.x===1/0?e.range()[0]:e(t.x),o=t.y===1/0?r.range()[0]:r(t.y),i=t.x2===1/0?e.range()[1]:e(t.x2),c=t.y2===1/0?r.range()[1]:r(t.y2);return"translate(".concat([isNaN(i)?a:Math.min(a,i),isNaN(c)?o:Math.min(o,c)],")")},d=function(t,n){var e=nt(t.data.subject)||{},r=n[t.xType],a=n[t.yType],o=t.x===1/0?r.range()[0]:r(t.x),i=t.y===1/0?a.range()[0]:a(t.y),c=t.x2===1/0?r.range()[1]:r(t.x2),l=t.y2===1/0?a.range()[1]:a(t.y2),d=t.x2?Math.abs(o-c):0,u=t.y2?Math.abs(i-l):0;return t.x2&&t.y2?(e.width=d,e.height=u):t.x2?(e.x1=0,e.x2=d):t.y2&&(e.y1=0,e.y2=u),e.dx=e.dx*d,e.dy=e.dy*u,e};r.__scales={x:c.x.copy(),y:c.y.copy(),x2:c.x2.copy(),y2:c.y2.copy()};var i=l.selectAll(".d2b-axis-annotation").data(e,function(t){return t.key}),u=i.enter().append("g"),s=i.exit();i.selectAll("*").remove(),i=i.merge(u),u.attr("class","d2b-axis-annotation").attr("transform",function(t){return o(t,a)}).style("opacity",0),t!==l&&(i=i.transition(t),s=s.transition(t)),i.attr("transform",function(t){return o(t,c)}).style("opacity",1),s.attr("transform",function(t){return o(t,c)}).style("opacity",0).remove(),i.each(function(r){var a=nt(r.data),o=N.select(this),i=$(n);a.x=0,a.y=0,a.color=r.color,a.subject=d(r,c),a.dx=(a.subject.dx||0)+(r.data.dx||0),a.dy=(a.subject.dy||0)+(r.data.dy||0),t!==l?o.transition(t).tween("annotation-tween",function(){var n=this,e=p.interpolateObject(this.__subject||d(r,c),a.subject);return function(t){n.__subject=a.subject=e(t),a.dx=(a.subject.dx||0)+(r.data.dx||0),a.dy=(a.subject.dy||0)+(r.data.dy||0),o.call(i.annotations([a]))}}):o.call(i.annotations([a]))})};function rt(){var f={};function b(t,n){var e=f.graphs(t,n).map(function(t,n){var r={data:t,index:n,align:f.align(t,n),tooltipGraph:f.tooltipGraph(t,n),shift:f.shift(t,n),stackBy:I(f.stackBy(t,n),n),key:f.key(t,n),color:f.color(t,n)};return r.values=f.values(t,n).map(function(t,n){var e={data:t,index:n,graph:r,key:f.pkey(t,n),x:f.px(t,n),y:f.py(t,n),color:f.pcolor(t,n)||r.color,annotation:f.pannotation(t,n)};return e.y1=e.y,e.y0=0,e}),r});return a.entries(e).forEach(function(t){1<t.values.length&&r(t.values)}),e}var n=function t(s){var p=s.selection?s.selection():s,n=p.selectAll(".d2b-line-graphs").data(function(t){return[t]}),e=(n=n.merge(n.enter().append("g").attr("class","d2b-line-graphs"))).selectAll(".d2b-line-graph").data(function(t,n){return b(t,n)},function(t){return t.key}),r=e.enter().append("g").attr("class","d2b-line-graph d2b-graph").style("opacity",0);r.append("path").attr("class","d2b-line").style("stroke",function(t){return t.color}).attr("d",function(t){var n=this.parentNode.parentNode,e=n.__scaleX,r=n.__scaleY;return h.call(this,t,e||f.x,r||f.y)});var a=e.merge(r).order(),o=e.exit(),i=a.select(".d2b-line");if(s!==p){a=a.transition(s),o=o.transition(s),i=i.transition(s);var c=o.style("opacity",0).select(".d2b-line"),l=function(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=R.max(t.values,function(t){return t.x}),r=R.min(t.values,function(t){return t.x});return y.interpolatePath(this.getAttribute("d"),h.call(this,t,f.x,f.y,n),function(t){return t.x==e||t.x==r})};void 0===y.interpolatePath?(c.attr("d",function(t){return h.call(this,t,f.x,f.y)}),i.attr("d",function(t){return h.call(this,t,f.x,f.y,!0)})):(c.attrTween("d",function(t){return l.call(this,t)}),i.attrTween("d",function(t){return l.call(this,t,!0)}))}else i.attr("d",function(t){return h.call(this,t,f.x,f.y,!0)});a.style("opacity",1),a.each(function(e){var t=this.parentNode,n=N.select(this),r=e.align,a=t.__scaleX||f.x,o=t.__scaleY||f.y,i=e.values.filter(function(t){return t.annotation}),c=n.selectAll(".d2b-line-annotation-group").data(i,function(t){return t.key}),l=c.enter().append("g");l.attr("class","d2b-line-annotation-group").attr("transform",function(t){return"translate(".concat(a(t.x)+e.shift,", ").concat(o(t[r]),")")});var d=c.merge(l),u=c.exit();s!==p&&(d=d.transition(s),u=u.transition(s)),d.style("opacity",1).attr("transform",function(t){return"translate(".concat(f.x(t.x)+e.shift,", ").concat(f.y(t[r]),")")}).call(tt,f.annotation,"d2b-line-annotation"),u.attr("transform",function(n){return n=e.values.filter(function(t){return n.key===t.key})[0]||n,"translate(".concat(f.x(n.x)+e.shift,", ").concat(f.y(n[r]),")")}).style("opacity",0).remove()}),o.remove().selectAll(".d2b-line-annotation-group").attr("transform",function(t){return"translate(".concat(f.x(t.x)+t.graph.shift,", ").concat(f.y(t[t.graph.align]),")")}),i.style("stroke",function(t){return t.color});var d=f.x.copy(),u=f.y.copy();return n.each(function(){this.__scaleX=d,this.__scaleY=u}),p.dispatch("svg-line-updated",{bubbles:!0}),t},h=function(n,e,r){var t=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=n.shift;null===a&&(a=e.bandwidth?e.bandwidth()/2:0),n.tooltipGraph&&t&&n.tooltipGraph.data(n.values).x(function(t){return e(t.x)+a}).y(function(t){return r(t[n.align])}).color(function(t){return t.color}),f.line.x(function(t){return e(t.x)+a}).y(function(t){return r(t[n.align])});var o=f.line(n.values);return H(o)?o:this.getAttribute("d")},r=d().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),a=u.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:D()});return T(n,f).addProp("line",s.line()).addProp("stack",r.stack(),null,function(t){return r.stack(t)}).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","line").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return b(t,n)})}).addMethod("getVisiblePoints",function(t){return n.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(n){return n.values.map(function(t){return{x:t.x,y:t[n.align],graph:n}})}))})[0]}),n}function at(){var f={};function b(t,n){var e=f.graphs(t,n).map(function(t,n){var r={data:t,index:n,tooltipGraph:f.tooltipGraph(t,n),shift:f.shift(t,n),stackBy:I(f.stackBy(t,n),n),key:f.key(t,n),color:f.color(t,n)};return r.values=f.values(t,n).map(function(t,n){var e={data:t,index:n,graph:r,key:f.pkey(t,n),x:f.px(t,n),y:f.py(t,n),y0:f.py0(t,n),color:f.pcolor(t,n)||r.color,annotations:f.pannotations(t,n)};return e.y1=e.y,e.y0=I(e.y0,0),e}),r});return a.entries(e).forEach(function(t){1<t.values.length&&r(t.values)}),e}var n=function t(u){var s=u.selection?u.selection():u,n=s.selectAll(".d2b-area-graphs").data(function(t){return[t]}),e=(n=n.merge(n.enter().append("g").attr("class","d2b-area-graphs"))).selectAll(".d2b-area-graph").data(function(t,n){return b(t,n)},function(t){return t.key}),r=e.enter().append("g").attr("class","d2b-area-graph d2b-graph").style("opacity",0);r.append("path").attr("class","d2b-area").style("fill",function(t){return t.color}).attr("d",function(t){var n=this.parentNode.parentNode,e=n.__scaleX,r=n.__scaleY;return h.call(this,t,e||f.x,r||f.y)});var a=e.merge(r).order(),o=e.exit(),i=a.select(".d2b-area");if(u!==s){a=a.transition(u),o=o.transition(u),i=i.transition(u);var c=o.style("opacity",0).select(".d2b-area"),l=function(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=R.max(t.values,function(t){return t.x}),r=R.min(t.values,function(t){return t.x});return y.interpolatePath(this.getAttribute("d"),h.call(this,t,f.x,f.y,n),function(t){return t.x==e||t.x==r})};void 0===y.interpolatePath?(c.attr("d",function(t){return h.call(this,t,f.x,f.y)}),i.attr("d",function(t){return h.call(this,t,f.x,f.y,!0)})):(c.attrTween("d",function(t){return l.call(this,t)}),i.attrTween("d",function(t){return l.call(this,t,!0)}))}else i.attr("d",function(t){return h.call(this,t,f.x,f.y,!0)});a.style("opacity",1),a.each(function(i){var t=this.parentNode,c=N.select(this),l=t.__scaleX||f.x,d=t.__scaleY||f.y;["y0","y1"].forEach(function(e){var t=i.values.filter(function(t){return(t.annotations||[]).filter(function(t){return(t.location||"y1")===e}).length}),n=c.selectAll(".d2b-area-annotation-group-"+e).data(t,function(t){return t.key}),r=n.enter().append("g");r.attr("class","d2b-area-annotation-group-"+e).attr("transform",function(t){return"translate(".concat(l(t.x)+i.shift,", ").concat(d(t[e]),")")});var a=n.merge(r),o=n.exit();u!==s&&(a=a.transition(u),o=o.transition(u)),a.style("opacity",1).attr("transform",function(t){return"translate(".concat(f.x(t.x)+i.shift,", ").concat(f.y(t[e]),")")}).call(tt,f.annotation,"d2b-area-annotation",function(t){return t.annotations.filter(function(t){return(t.location||"y1")===e})}),o.attr("transform",function(n){return n=i.values.filter(function(t){return n.key===t.key})[0]||n,"translate(".concat(f.x(n.x)+i.shift,", ").concat(f.y(n[e]),")")}).style("opacity",0).remove()})}),o.remove(),o.selectAll(".d2b-area-annotation-group-y0").attr("transform",function(t){return"translate(".concat(f.x(t.x)+t.graph.shift,", ").concat(f.y(t.y0),")")}),o.selectAll(".d2b-area-annotation-group-y1").attr("transform",function(t){return"translate(".concat(f.x(t.x)+t.graph.shift,", ").concat(f.y(t.y1),")")}),i.style("fill",function(t){return t.color});var d=f.x.copy(),p=f.y.copy();return n.each(function(){this.__scaleX=d,this.__scaleY=p}),s.dispatch("svg-area-updated",{bubbles:!0}),t},h=function(t,n,e){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=t.shift;null===a&&(a=n.bandwidth?n.bandwidth()/2:0),t.tooltipGraph&&r&&t.tooltipGraph.data(t.values).x(function(t){return n(t.x)+a}).y(function(t){return e(t.y1)}).color(function(t){return t.color}),f.area.x(function(t){return n(t.x)+a}).y0(function(t){return e(t.y0)}).y1(function(t){return e(t.y1)});var o=f.area(t.values);return H(o)?o:this.getAttribute("d")},r=d().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),a=u.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:D()});return T(n,f).addProp("area",s.area()).addProp("stack",r.stack(),null,function(t){return r.stack(t)}).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","area").addPropFunctor("graphs",function(t){return t}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("py0",function(t){return t.y0}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotations",function(t){return t.annotations}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return b(t,n)})}).addMethod("getVisiblePoints",function(t){return n.getComputedGraphs(t).map(function(t){var n=[].concat.apply([],t.map(function(n){return n.values.map(function(t){return{x:t.x,y:t.y0,graph:n}})})),e=[].concat.apply([],t.map(function(n){return n.values.map(function(t){return{x:t.x,y:t.y1,graph:n}})}));return n.concat(e)})[0]}),n}function ot(){var h={};function i(t,n){var e=h.graphs(t,n).map(function(t,n){var r={data:t,index:n,align:h.align(t,n),tooltipGraph:h.tooltipGraph(t,n),shift:h.shift(t,n),stackBy:I(h.stackBy(t,n),n),key:h.key(t,n),color:h.color(t,n),symbol:h.symbol(t,n)};return r.values=h.values(t,n).map(function(t,n){var e={data:t,index:n,graph:r,x:h.px(t,n),y:h.py(t,n),color:h.pcolor(t,n)||r.color,symbol:h.psymbol(t,n)||r.symbol,key:h.pkey(t,n),size:h.psize(t,n),annotation:h.pannotation(t,n)};return e.y1=e.y,e.y0=0,e}),r});return a.entries(e).forEach(function(t){1<t.values.length&&r(t.values)}),e}var n=function t(f){var b=f.selection?f.selection():f,n=b.selectAll(".d2b-scatter-graphs").data(function(t){return[t]}),e=(n=n.merge(n.enter().append("g").attr("class","d2b-scatter-graphs"))).selectAll(".d2b-scatter-graph").data(function(t,n){return i(t,n)},function(t){return t.key}),r=e.enter().append("g").attr("class","d2b-scatter-graph d2b-graph").style("opacity",0),a=e.merge(r).order(),o=e.exit();return f!==b&&(a=a.transition(f),(o=o.transition(f)).style("opacity",0).each(function(t){var n=N.select(this),e=h.x,r=h.y,a=n.selectAll(".d2b-scatter-point");f!==b&&(a=a.transition(f));var o=t.shift;null===o&&(o=e.bandwidth?e.bandwidth()/2:0),a.style("opacity",0).call(y,e,r,o,t.align).remove()})),a.style("opacity",1),o.remove(),a.each(function(t){var n=N.select(this),e=h.x,r=h.y,a=this.parentNode,o=a.__scaleX||e,i=a.__scaleY||r,c=t.shift;null===c&&(c=e.bandwidth?e.bandwidth()/2:0);var l=c;null===l&&(c=o.bandwidth?o.bandwidth()/2:0),t.tooltipGraph&&t.tooltipGraph.data(t.values).x(function(t){return e(t.x)+c}).y(function(t){return r(t.y)}).color(function(t){return t.color}),h.point.fill(function(t){return t.color}).type(function(t){return t.symbol}).size(function(t){return t.size});var d=n.selectAll(".d2b-scatter-point").data(t.values,function(t){return t.key}),u=d.enter().append("g").attr("class","d2b-scatter-point"),s=d.merge(u).order(),p=d.exit();f!==b&&(s=s.transition(f),p=p.transition(f)),o.bandwidth||i.bandwidth||e.bandwidth||r.bandwidth?u.call(y,e,r,c,t.align):u.call(y,o,i,l,t.align),u.style("opacity",0),s.style("opacity",1).call(h.point).call(y,e,r,c,t.align),p.style("opacity",0).call(y,e,r,c,t.align).remove(),tt(s,h.annotation,"d2b-scatter-annotation")}),n.each(function(){this.__scaleX=h.x.copy(),this.__scaleY=h.y.copy()}),b.dispatch("svg-scatter-updated",{bubbles:!0}),t};function y(t,r,a,o,i){t.attr("transform",function(t){var n=a(t[i]),e=r(t.x)+o;return isFinite(e)&&isFinite(n)?"translate(".concat([e,n],")"):this.getAttribute("transform")})}var r=d().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),a=u.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:D()});return T(n,h).addProp("point",q().active(!0)).addProp("stack",r.stack(),null,function(t){return r.stack(t)}).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","scatter").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("symbol",function(){return s.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("psize",25).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return i(t,n)})}).addMethod("getVisiblePoints",function(t){return n.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(n){return n.values.map(function(t){return{x:t.x,y:t[n.align],graph:n}})}))})[0]}),n}function it(){var _={};function M(t){return"horizontal"===t?{rotate:!0,px:"py",py:"px",x:"y",y:"x",w:"height",h:"width"}:{rotate:!1,px:"px",py:"py",x:"x",y:"y",w:"width",h:"height"}}function z(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:M(_.orient(t,n)),r=_.graphs(t,n).map(function(t,n){var e={data:t,index:n,tooltipGraph:_.tooltipGraph(t,n),shift:_.shift(t,n),stackBy:I(_.stackBy(t,n),n),key:_.key(t,n),color:_.color(t,n)};return e.values=_.values(t,n).map(function(t,n){return{data:t,index:n,graph:e,key:_.pkey(t,n),x:_.px(t,n),y:_.py(t,n),centered:_.pcentered(t,n),color:_.pcolor(t,n)||e.color,annotation:_.pannotation(t,n)}}),e});return a.x(function(t){return t[e.x]}).y(function(t){return t[e.y]}),E.entries(r).forEach(function(t,n){return a.out(function(o){var i={};return function(t,n,e,r){var a=i[r]=i[r]||[0,0];t.dy=e-n,t.stackIndex=o,t.base=r,0<t.dy?t.extent=[a[0],a[0]+=t.dy]:t.extent=[a[1],a[1]+=t.dy]}}(n))(t.values)}),function(t,n){if(null===n){var e=[].concat.apply([],t.map(function(t){return t.values})),r=R.extent(e.map(function(t){return t.extent[1]}));n=r[1]<0?r[1]:0<r[0]?r[0]:0}t.forEach(function(t){t.values.forEach(function(t){Math.abs(t.extent[0])<Math.abs(n)&&(t.extent[0]=n)})})}(r,_.baseline(t,n,[].concat.apply([],r.map(function(t){return t.values.map(function(t){return t.extent[1]})})))),r}var t=function t(w){var F=w.selection?w.selection():w,A={x:_.x,y:_.y};return F.each(function(t,n){var c=M(_.orient(t,n)),e=z(t,n,c),l=A[c.x].copy(),d=A[c.y].copy(),r=_.padding(t,n),a=_.groupPadding(t,n),o=_.bandwidth(t,n);o=(1-r)*I(o||function(r,t,a){var o=[],i=1/0;t.forEach(function(t){var n=t.values,e=r.range();i=Math.min(i,Math.abs(e[1]-e[0])),n.forEach(function(t){o.push(r(t[a.x]))})}),o.sort(R.ascending);for(var n=0;n<o.length-1;n++)o[n+1]!==o[n]&&(i=Math.min(o[n+1]-o[n],i));return i===1/0?0:i}(l,e,c));var i=E.entries(e),u=o/Math.max(1,i.length),s=function(r,a,o,i){return function(t,n){var e=t.centered?n-a/4:n-a/2+t.stackIndex*o+i;return r(t.base)+e}}(l,o,u,a*=u),p=function(n){var e=function(t){return[n(t.extent[0]),n(t.extent[1])]};return e.sorted=function(t){return e(t).slice().sort(R.ascending)},e}(d);u-=2*a;var f=N.select(this).selectAll(".d2b-bar-graphs").data(function(t){return[t]}),b=(f=f.merge(f.enter().append("g").attr("class","d2b-bar-graphs"))).node(),h=b.__scaleBase||s,y=b.__scaleY||d,g=b.__scaleX||l,x=b.__barWidth||u,v=f.selectAll(".d2b-bar-graph").data(e.slice().reverse(),function(t){return t.key}),m=v.enter().append("g").attr("class","d2b-bar-graph d2b-graph"),k=v.merge(m).order(),P=v.exit();w!==F&&(k=k.transition(w),(P=P.transition(w)).each(function(t){var n=t.shift;null===n&&(n=l.bandwidth?l.bandwidth()/2:0);var e=N.select(this).selectAll(".d2b-bar-group").transition(w);g.bandwidth||y.bandwidth||l.bandwidth||d.bandwidth?e.style("opacity",0):e.call(C,{opacity:0,x:function(t){return s(t,n)},y:function(){return d(0)},width:u,height:function(){return 0},graph:t,orientMap:c})})),P.remove(),k.each(function(t){var n=N.select(this),e=t.shift;null===e&&(e=l.bandwidth?l.bandwidth()/2:0);var r=n.selectAll(".d2b-bar-group").data(t.values,function(t){return t.key}),a=r.enter().append("g").attr("class","d2b-bar-group");a.append("rect"),a.append("g").attr("class","d2b-bar-annotation-group");var o=r.merge(a).order(),i=r.exit();t.tooltipGraph&&t.tooltipGraph.data(t.values)[c.x](function(t){return l(t.base)+e})[c.y](function(t){return p(t)[1]}).color(function(t){return t.color}),w!==F&&(o=o.transition(w),i=i.transition(w)),a.attr("class","d2b-bar-group"),i.remove(),g.bandwidth||y.bandwidth||l.bandwidth||d.bandwidth?(a.call(C,{opacity:0,x:function(t){return s(t,e)},y:function(){return d(0)},width:x,height:function(){return 0},graph:t,orientMap:c}),i.style("opacity",0)):(a.call(C,{opacity:0,x:function(t){return h(t,e)},y:function(){return y(0)},width:x,height:function(){return 0},graph:t,orientMap:c}),i.call(C,{opacity:0,x:function(t){return s(t,e)},y:function(){return d(0)},width:u,height:function(){return 0},graph:t,orientMap:c})),o.call(C,{opacity:1,x:function(t){return s(t,e)},y:function(t){return p.sorted(t)[0]},width:u,height:function(t){return p.sorted(t)[1]-p.sorted(t)[0]},graph:t,orientMap:c})}),b.__scaleY=d,b.__scaleX=l,b.__scaleBase=s,b.__barWidth=u}),F.dispatch("svg-bar-updated",{bubbles:!0}),t},a=d().values(function(t){return t.values}),E=u.nest().key(function(t){return t.stackBy});function C(t,n){t.style("opacity",n.opacity).call(e,n).select("rect").attr("fill",function(t){return t.color}).attr(n.orientMap.w,n.width).attr(n.orientMap.h,n.height),t.select(".d2b-bar-annotation-group").call(r,n).call(tt,_.annotation,"d2b-bar-annotation")}function e(t,r){t.attr("transform",function(t){var n=r[r.orientMap.x](t),e=r[r.orientMap.y](t);return"translate(".concat([n,e],")")})}function r(t,e){t.attr("transform",function(t){var n={x:e.width/2,y:t.extent[0]<t.extent[1]?0:e.height(t)};return"translate(".concat([n[e.orientMap.x],n[e.orientMap.y]],")")})}return T(t,_).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","bar").addPropFunctor("graphs",function(t){return t}).addPropFunctor("padding",.5).addPropFunctor("groupPadding",0).addPropFunctor("bandwidth",null).addPropFunctor("baseline",0).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("orient","vertical").addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values},null).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcentered",!1).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return z(t,n)})}).addMethod("getVisiblePoints",function(t){return(t.selection?t.selection():t).data().map(function(t,n){var r=M(_.orient(t,n)),e=z(t,n,r),a=[].concat.apply([],e.map(function(e){return e.values.map(function(t){var n={};return n["".concat(r.x)]=t.base,n["".concat(r.y)]=t.extent[0],n.graph=e,n})})),o=[].concat.apply([],e.map(function(e){return e.values.map(function(t){var n={};return n["".concat(r.x)]=t.base,n["".concat(r.y)]=t.extent[1],n.graph=e,n})}));return a.concat(o)})[0]}),t}function ct(){var g={},t=function t(i){var c=i.selection?i.selection():i,l=g.scale,d=g.enterScale||l,u=g.valueFormat,s="vertical"===g.orient,p=s?{x:"x",y:"y",x1:"x1",x2:"x2",y1:"y1",y2:"y2",width:"width",height:"height",cx:"cx",cy:"cy",translate:function(t,n){return"translate(".concat(t,", ").concat(n,")")}}:{x:"y",y:"x",x1:"y1",x2:"y2",y1:"x1",y2:"x2",width:"height",height:"width",cx:"cy",cy:"cx",translate:function(t,n){return"translate(".concat(n,", ").concat(t,")")}},n=c.selectAll(".d2b-box").data(function(t,n){t=g.data(t,n);var e=g.outliers(t,n)||[],r=g.minimum(t,n),a=g.maximum(t,n);return[{data:t,index:n,median:g.median(t,n),upperQuartile:g.upperQuartile(t,n),lowerQuartile:g.lowerQuartile(t,n),minimum:r,maximum:a,outliers:e,maxOutliers:e.filter(function(t){return a<t}),minOutliers:e.filter(function(t){return t<r}),color:g.color(t,n),width:g.width(t,n),annotations:g.annotations(t,n)}]}),e=n.enter().append("g").attr("class","d2b-box"),f=n.merge(e).order(),r=f.selectAll(".d2b-box-center").data(function(t){return[t]}),a=r.enter().append("line").attr(p.x1,0).attr(p.x2,0).attr(p.y1,function(t){return d(t.minimum)}).attr(p.y2,function(t){return d(t.maximum)}).attr("class","d2b-box-center"),o=r.merge(a),b=f.selectAll(".d2b-box-rect").data(function(t){return[t]}),h=b.enter().append("rect").attr("class","d2b-box-rect").attr(p.width,function(t){return t.width}).attr(p.height,function(t){return Math.abs(d(t.upperQuartile)-d(t.lowerQuartile))}).attr(p.x,function(t){return-t.width/2}).attr(p.y,function(t){return Math.min(d(t.upperQuartile),d(t.lowerQuartile))}),y=b.merge(h);return["max","min"].forEach(function(t){var n=f.selectAll(".d2b-box-".concat(t,"-outlier")).data(function(n){return n["".concat(t,"Outliers")].map(function(t){return{outlier:t,box:n}})}),e=n.enter().append("circle").style("opacity",0).attr("r",function(t){return t.box.width/5}).attr(p.cx,0).attr(p.cy,function(t){return d(t.outlier)}).attr("class","d2b-box-outlier d2b-box-".concat(t,"-outlier")),r=n.merge(e),a=n.exit();i!==c&&(r=r.transition(i),a=a.transition(i)),r.style("opacity",1).attr("stroke",function(t){return t.box.color}).attr("r",function(t){return t.box.width/5}).attr(p.cx,0).attr(p.cy,function(t){return l(t.outlier)}),a.attr(p.cx,0).attr(p.cy,function(t){return l(t.outlier)}).style("opacity",0).remove()}),["maximum","median","minimum"].forEach(function(n){var t=f.selectAll(".d2b-box-dash-".concat(n)).data(function(t){return[t]}),e=t.enter().append("line").attr("class","d2b-box-dash d2b-box-dash-".concat(n)).attr(p.x1,function(t){return-t.width/2}).attr(p.x2,function(t){return t.width/2}).attr(p.y1,function(t){return d(t[n])}).attr(p.y2,function(t){return d(t[n])}),r=t.merge(e);i!==c&&(r=r.transition(i)),r.attr("stroke",function(t){return t.color}).attr(p.x1,function(t){return-t.width/2}).attr(p.x2,function(t){return t.width/2}).attr(p.y1,function(t){return l(t[n])}).attr(p.y2,function(t){return l(t[n])})}),["maximum","upperQuartile","median","lowerQuartile","minimum"].forEach(function(n,e){var t=f.selectAll(".d2b-box-label-group-".concat(n)).data(function(t){return[t]}),r=t.enter().append("g").attr("class","d2b-box-label-group d2b-box-label-group-".concat(n)).attr("transform",function(t){return p.translate(0,d(t[n]))});r.append("text").attr("class","d2b-box-label").attr(p.x,function(t){return(3+t.width/2)*(e%2==0?1:-1)}).style("text-anchor",e%2==0?"start":"end");var a=t.merge(r);i!==c&&(a=a.transition(i)),a.attr("transform",function(t){return p.translate(0,l(t[n]))}).call(tt,g.annotation,"d2b-box-annotation",function(t){return(t.annotations||[]).filter(function(t){return(t.location||"median")===n})});var o=a.select(".d2b-box-label").text(function(t){return u(t[n])});s?o.select().style("text-anchor",e%2==0?"start":"end").style("dominant-baseline","middle").attr(p.x,function(t){return(3+t.width/2)*(e%2==0?1:-1)}):o.style("text-anchor","middle").style("dominant-baseline",e%2==0?"baseline":"hanging").attr(p.x,function(t){return(3+t.width/2)*(e%2==0?-1:1)})}),i!==c&&(y=y.transition(i),o=o.transition(i)),y.attr(p.x,function(t){return-t.width/2}).attr(p.y,function(t){return Math.min(l(t.upperQuartile),l(t.lowerQuartile))}).attr(p.width,function(t){return t.width}).attr(p.height,function(t){return Math.abs(l(t.upperQuartile)-l(t.lowerQuartile))}).attr("stroke",function(t){return t.color}),o.attr(p.x1,0).attr(p.x2,0).attr(p.y1,function(t){return l(t.minimum)}).attr(p.y2,function(t){return l(t.maximum)}).attr("stroke",function(t){return t.color}),c.dispatch("box-updated",{bubbles:!0}),t};return T(t,g).addProp("scale",P.scaleLinear()).addProp("enterScale",null).addProp("valueFormat",a.format(",")).addProp("orient","vertical").addProp("annotation",o.annotation?o.annotation():null).addPropFunctor("data",function(t){return t}).addPropFunctor("median",function(t){return t.median}).addPropFunctor("upperQuartile",function(t){return t.upperQuartile}).addPropFunctor("lowerQuartile",function(t){return t.lowerQuartile}).addPropFunctor("minimum",function(t){return t.minimum}).addPropFunctor("maximum",function(t){return t.maximum}).addPropFunctor("outliers",function(t){return t.outliers}).addPropFunctor("width",20).addPropFunctor("color","steelblue").addPropFunctor("annotations",function(t){return t.annotations}),t}function lt(){var g={};function i(t,n){return g.graphs(t,n).map(function(t,n){var e={data:t,index:n,tooltipGraph:g.tooltipGraph(t,n),shift:g.shift(t,n),key:g.key(t,n),color:g.color(t,n),orient:g.orient(t,n)};return e.values=g.values(t,n).map(function(t,n){return{data:t,index:n,graph:e,x:g.px(t,n),y:g.py(t,n),annotations:g.pannotations(t,n),median:g.box.median()(t,n)}}),e})}var e=function t(h){var y=h.selection?h.selection():h,n=y.selectAll(".d2b-box-plot-graphs").data(function(t){return[t]}),e=(n=n.merge(n.enter().append("g").attr("class","d2b-box-plot-graphs"))).selectAll(".d2b-box-plot-graph").data(function(t,n){return i(t,n)},function(t){return t.key}),r=e.enter().append("g").attr("class","d2b-box-plot-graph d2b-graph").style("opacity",0),a=e.merge(r).order(),o=e.exit();return g.box.data(function(t){return t.data}).annotation(g.annotation).annotations(g.pannotations),h!==y&&(a=a.transition(h),(o=o.transition(h)).style("opacity",0).each(function(e){var t=N.select(this),n="vertical"===e.orient,r=n?{x:"x",y:"y"}:{x:"y",y:"x"},a=g[r.x],o=g[r.y];g.box.scale(o).orient(e.orient).color(function(t,n){return g.pcolor(t,n)||e.color});var i=t.selectAll(".d2b-box-plot-box");h!==y&&(i=i.transition(h));var c=e.shift;null===c&&(c=a.bandwidth?a.bandwidth()/2:0),i.style("opacity",0).attr("transform",function(t){return x(a(t[r.x])+c,n)}).call(g.box).remove()})),a.style("opacity",1),o.remove(),a.each(function(e){var t=N.select(this),n="vertical"===e.orient,r=n?{x:"x",y:"y"}:{x:"y",y:"x"},a=g[r.x],o=g[r.y],i=this.parentNode,c={x:i.__scaleX||a,y:i.__scaleY||o},l=c[r.x],d=c[r.y],u=e.shift;null===u&&(u=a.bandwidth?a.bandwidth()/2:0),null===u&&(u=l.bandwidth?l.bandwidth()/2:0),e.tooltipGraph&&e.tooltipGraph.data(e.values)[r.x](function(t){return a(t[r.x])+u})[r.y](function(t){return o(t.median)}).color(function(t,n){return g.pcolor(t.data,n)||e.color}),g.box.scale(o).enterScale(d).orient(e.orient).color(function(t,n){return g.pcolor(t,n)||e.color});var s=t.selectAll(".d2b-box-plot-box").data(e.values,g.pkey),p=s.enter().append("g").attr("class","d2b-box-plot-box"),f=s.merge(p).order(),b=s.exit();h!==y&&(f=f.transition(h),b=b.transition(h)),l.bandwidth||d.bandwidth||a.bandwidth||o.bandwidth?(g.box.enterScale(o),p.attr("transform",function(t){return x(a(t[r.x])+u,n)})):(g.box.enterScale(d),p.attr("transform",function(t){return x(l(t[r.x])+u,n)})),p.style("opacity",0),f.attr("transform",function(t){return x(a(t[r.x])+u,n)}).style("opacity",1).call(g.box),b.attr("transform",function(t){return x(a(t[r.x])+u,n)}).style("opacity",0).call(g.box).remove()}),n.each(function(){this.__scaleX=g.x.copy(),this.__scaleY=g.y.copy()}),y.dispatch("svg-box-updated",{bubbles:!0}),t};function x(t,n){return"translate(".concat(n?[t,0]:[0,t],")")}return T(e,g).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("box",ct()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","boxPlot").addPropFunctor("graphs",function(t){return t}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("orient","vertical").addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotations",function(t){return t.annotations}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return i(t,n)})}).addMethod("getVisiblePoints",function(t){var n=e.getComputedGraphs(t),i=[];return n.forEach(function(t){t.forEach(function(a){var o="vertical"===a.orient?{x:"x",y:"y"}:{x:"y",y:"x"};a.values.forEach(function(e,r){["maximum","minimum","upperQuartile","lowerQuartile","median"].forEach(function(t){var n={graph:a};n[o.x]=e[o.x],n[o.y]=g.box[t]()(e.data,r),i.push(n)}),(g.box.outliers()(e.data,r)||[]).forEach(function(t){var n={graph:a};n[o.x]=e[o.x],n[o.y]=t,i.push(n)})})})}),i}),e}function dt(){var v={},m=s.symbol().size(80);function c(t,n){var e=v.graphs(t,n).map(function(t,n){var e={data:t,index:n,tendancy:v.tendancy(t,n),tooltipGraph:v.tooltipGraph(t,n),shift:v.shift(t,n),key:v.key(t,n),color:v.color(t,n),symbol:v.symbol(t,n)};return e.values=v.values(t,n).map(function(t,n){return function e(t,n,r){return{data:t,index:n,graph:r,x:v.px(t,n),y:v.py(t,n),color:v.pcolor(t,n)||r.color,symbol:v.psymbol(t,n)||r.symbol,key:v.pkey(t,n),size:v.psize(t,n),indicator:v.pindicator(t,n),annotation:v.pannotation(t,n),children:(v.pchildren(t,n)||[]).map(function(t,n){return e(t,n,r)})}}(t,n,e)}),e});return e.forEach(function(n){return n.values.forEach(function(t){return function n(e,r){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;e.children=e.children||[];e.leaves=e.children.length?[]:[e];e.depth=a;e.children.length&&e.children.forEach(function(t){n(t,r,a+1),(t.parent=e).leaves=e.leaves.concat(t.leaves)});e.size=I(e.size,R.sum(e.leaves,function(t){return t.size}));e.x=I(e.x,(r.x||r)(e.leaves,function(t){return t.x},function(t){return t.size}));e.y=I(e.y,(r.y||r)(e.leaves,function(t){return t.y},function(t){return t.size}))}(t,n.tendancy)})}),e}var n=function d(t){var u=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],s=t.selection?t:null,n=t.selection?t.selection():t,e=n.selectAll(".d2b-bubble-pack-graphs").data(function(t){return[t]}),r=(e=e.merge(e.enter().append("g").attr("class","d2b-bubble-pack-graphs"))).selectAll(".d2b-bubble-pack-graph").data(function(t,n){return c(t,n)},function(t){return t.key}),a=r.enter().append("g").attr("class","d2b-bubble-pack-graph d2b-graph"),o=r.merge(a).order(),i=r.exit();return s&&(o=o.transition(s),i=i.transition(s)),o.style("opacity",1),i.style("opacity",0).remove(),t.each(function(t,n){var o=N.select(this),e=v.duration(t,n),r=o.selectAll(".d2b-bubble-pack-graph"),a=o.selectAll(".d2b-bubble-pack-graphs").node(),i=a.__d2bPreserveScaleX__||v.x,c=a.__d2bPreserveScaleY__||v.y;o.on("change",function(){o.transition().duration(e).call(d,!1)});var l=0;r.each(function(t){var n=N.select(this),e=v.x.range();l=Math.max(l,Math.abs(e[0]-e[1]));var r=t.shift;null===r&&(r=v.x.bandwidth?v.x.bandwidth()/2:0),v.point.active(function(t){return!!t.children.length}).fill(function(t){return t.color}).type(function(t){return t.symbol});var a=t.tooltipGraph?t.tooltipGraph.clear().x(function(t){return v.x(t.x)+r}).y(function(t){return v.y(t.y)}).color(function(t){return t.color}).addPoint:null;!function r(t,n,a,o,i,c,l,d,u,s,p){var f=11<arguments.length&&void 0!==arguments[11]?arguments[11]:0;var e=t.selectAll(".d2b-bubble-pack.d2b-depth-".concat(f)).data(n,function(t){return t.key}),b=e.enter().append("g").attr("class","d2b-bubble-pack d2b-depth-".concat(f)),h=e.merge(b);var y=b.append("g").attr("class","d2b-bubble-point");p&&k(y,!1,c,l,d);y.style("opacity",0);k(h.select(".d2b-bubble-point"),a,o,i,d);b.append("g").attr("class","d2b-bubble-indicator");g=h.select(".d2b-bubble-indicator"),g.each(function(t){var n=N.select(this).classed("d2b-active",t.data.expanded);if(!t.data.expanded)return n.selectAll("rect, text, path").remove();var e=n.select("rect"),r=n.select("text"),a=n.select("path");e.size()||(e=n.append("rect")),r.size()||(r=n.append("text")),a.size()||(a=n.append("path")),r.text(function(t){return t.indicator.substring(0,5)}).attr("x",20);var o=r.node().getBBox();r.attr("y",o.height/1.35),e.on("click",function(){N.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){t.data.expanded=!t.data.expanded,t.data.expanded||function n(t,e){t.data.expanded=e;t.children.forEach(function(t){return n(t,e)})}(t,!1)}).attr("width",o.width+25).attr("height",o.height).style("fill",v.point.fill()).style("stroke",v.point.stroke()),a.attr("d",function(t){return m.type(t.symbol)()}).attr("transform","translate(10, 9.5)").style("fill",v.point.stroke())});var g;h.each(function(t){var n=N.select(this),e=n.selectAll(".d2b-bubble-pack");e=a?e.transition(a):e,t.children.length&&t.data.expanded?r(n,t.children,a,o,i,c,l,d,u,s,p,f+1):(s&&s(t),e.remove().select(".d2b-bubble-point").style("opacity",0).attr("transform","translate(".concat([o(t.x)+d,i(t.y)],")")))});var x=e.exit();a&&(x=x.transition(a));x.remove()}(n,t.values,s,v.x,v.y,i,c,r,o,a,u)}),function(t,e){var r=5,a=5;t.selectAll(".d2b-bubble-indicator.d2b-active").attr("transform",function(){var t=this.getBBox();t.width+r>e&&0<r&&(r=5,a+=t.height+5);var n="translate(".concat(r,", ").concat(a,")");return r+=t.width+5,n})}(o,l)}),e.each(function(){this.__d2bPreserveScaleX__=v.x.copy(),this.__d2bPreserveScaleY__=v.y.copy()}),n.dispatch("svg-bubble-pack-updated",{bubbles:!0}),d};function k(t,e,r,a,o){t.each(function(t){var n=N.select(this);n.attr("transform")||n.attr("transform","translate("+"".concat(r(t.parent?t.parent.x:t.x)+o,",")+"".concat(a(t.parent?t.parent.y:t.y),")")),t.children.length&&!t.data.expanded?n.attr("cursor","pointer").on("click",function(){N.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){return t.data.expanded=!t.data.expanded}):n.attr("cursor","").on("click",null),e&&(n=n.transition(e)),t.data.expanded?n.style("opacity",0).selectAll("*").remove():n.style("opacity",null).call(v.point),n.attr("transform","translate(".concat(r(t.x)+o,", ").concat(a(t.y),")")),tt(n,v.annotation,"d2b-bubble-annotation")})}return T(n,v).addProp("point",q().size(function(t){return 100*t.size})).addProp("x",P.scaleLinear()).addProp("y",P.scaleLinear()).addProp("annotation",o.annotation?o.annotation():null).addPropGet("type","bubblePack").addPropFunctor("duration",250).addPropFunctor("graphs",function(t){return t}).addPropFunctor("tendancy",z,function(t){return arguments.length?(t&&t.tendancy?v.tendancy=function(){return t}:v.tendancy=x(t),n):v.tendancy}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("symbol",function(){return s.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("psize",function(t){return t.size}).addPropFunctor("pchildren",function(t){return t.children}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pindicator",function(t){return t.label}).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return c(t,n)})}).addMethod("getVisiblePoints",function(t){return n.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(n){var e=[];return n.values.forEach(function(t){return function n(t,e,r){t.data.expanded?t.children.forEach(function(t){return n(t,e,r)}):e.push({x:t.x,y:t.y,graph:r})}(t,e,n)}),e}))})[0]}),n}function ut(){var b={_id:Math.round(1e4*Math.random())},h=function(t){var n=N.select(this.parentNode).datum(),e=n.endAngle,r=n.startAngle,a=n.innerRadius,o=n.outerRadius,i=e-r,c=Math.max(0,(a+o)/2)*i;return 6*b.label(t.data).length<c},t=function s(p){var f=p.selection?p.selection():p;return b.pie.value(function(t){return t.value}),f.each(function(n,e){var r=N.select(this),t=b.zoomable(n,e),a=b.highlight(n,e),o=b.innerRadius(n,e),i=b.showLabels(n,e),c=function(t){return y(F.hierarchy(t,b.children).sum(function(t){var n=b.children(t);if(!n||!n.length)return b.size(t)}))}(b.root(n,e)),l=function(t){var n=null;t.each(function(t){t.data.selected&&(n=t)}),n||(n=t);return n.data.selected=!0,n}(c);!function(t,n){t.ancestors().concat(t.descendants()).filter(function(t){return t.depth<=n&&0<t.value}).forEach(function(t){return t.visible=!0})}(l,b.descendantLevels(n,e)+l.depth),c.each(function(t){return t.selected=l});var d=function(t,n,e,r){var a=b.innerRadius(t,n),o=b.outerRadius(t,n),i=b.ancestorPadding(t,n),c=b.ancestorRatio(t,n),l=0;e.each(function(t){t.visible&&(l=Math.max(l,t.depth))});var d=a+(o-a-i)*c,u=b.ancestorBanding.copy().range([a,d]).domain([0,r.depth+1]),s=b.descendantBanding.copy().range([d+i,o]).domain([r.depth+1,l+1]);return function(t){var n;return{inner:(n=t<=r.depth?u:s)(t),outer:n(t+1)}}}(n,e,c,l);v.call(this,[c],"arc",0,b.startAngle(n,e),b.endAngle(n,e),{transition:p!==f?p:null,oldRadii:I(this.__radii,d),radii:d,zoomable:t}),v.call(this,i?[c]:[],"label",0,b.startAngle(n,e),b.endAngle(n,e),{transition:p!==f?p:null,oldRadii:I(this.__radii,d),radii:d});var u=r.selectAll(".d2b-sunburst-center");u.data([l]).enter().append("circle").attr("class","d2b-sunburst-center").merge(u).attr("cx",0).attr("cy",0).attr("r",Math.max(0,o)).on("click",function(t){t.parent&&(t.data.selected=!1,t.parent.data.selected=!0,r.transition().duration(b.duration(t,e)).call(s),f.dispatch("chart-updated",{bubbles:!0}))}),this.__radii=d,r.selectAll("path.d2b-sunburst-arc").on("click",t?function(t){c.each(function(t){return t.data.selected=!1}),t.data.selected=!0,r.transition().duration(b.duration(n,e)).call(s),f.dispatch("chart-updated",{bubbles:!0})}:null).on("mouseover",a?function(t){var n=t.ancestors();r.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",function(t){return-1===n.indexOf(t)}),r.selectAll(".d2b-sunburst-label").classed("d2b-transparent",function(t){return-1===n.indexOf(t)})}:null).on("mouseout",function(){r.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",!1),r.selectAll(".d2b-sunburst-label").classed("d2b-transparent",!1)})}),f.dispatch("svg-sunburst-updated",{bubbles:!0}),s};function y(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(t.key=b.key(t.data,n),t.color=b.color(t.data,n),t.label=b.label(t.data,n),t.size=b.size(t.data,n),t.value=t.size,t.children)return t.children.forEach(y),t.value=e(t),t}function e(t){return I(t.size,t.children?R.sum(t.children,e):0)}function g(t){return t>Math.PI?Y(t)+90:Y(t)-90}function x(t,n){var e=(n.inner-n.outer)/2.2;return t>Math.PI?-e:e}function v(a,o,i,t,n,c){var r="arc"===o?A:_;a=a.filter(function(t){return t.visible}),b.pie.startAngle(t).endAngle(n),b.pie(a).forEach(function(t){var n=c.radii(t.data.depth),e=Math.round(1e4*Math.random());t.data.startAngle=t.startAngle,t.data.endAngle=t.endAngle,t.data.padAngle=t.padAngle,t.data.innerRadius=n.inner,t.data.outerRadius=n.outer,t.data.centerAngle=(t.startAngle+t.endAngle)/2,t.data.rotate=g(t.data.centerAngle),t.data.labelOffset=x(t.data.centerAngle,n),t.data.labelAnchor=function(t){return t>Math.PI?"end":"start"}(t.data.centerAngle),"arc"===o&&(t.data._id=e)});var e,l=N.select(this),d="d2b-sunburst-level-".concat(i),u=l.selectAll(".d2b-sunburst-".concat(o,"-group.").concat(d)),s=u.data(),p=(u=u.data(a,function(t){return t.key})).enter().append("g").attr("class","d2b-sunburst-".concat(o,"-group ").concat(d));"arc"===o?(e=p.append("arc"===o?"path":"text").attr("class","d2b-sunburst-".concat(o," ").concat(d)).each(function(t,n){var e=c.oldRadii(t.depth),r=t.neighbor||m(n,s,a);this.current={startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:e.inner,outerRadius:e.outer,rotate:g((r.startAngle+r.endAngle)/2)},t.children&&t.children.forEach(function(t){return t.neighbor=r})}),p.append("path").attr("class","d2b-hidden-arc").attr("id",function(t){return"".concat(d,"-hiddenArc").concat(t._id,"-").concat(b._id)}).attr("d",function(t){var n=t.innerRadius,e=t.outerRadius,r=t.startAngle,a=t.endAngle,o=Math.PI/2,i=(n+e)/2,c=[r-o,a-o],l=(c[1]+c[0])/2,d=0<l&&l<Math.PI;d&&c.reverse();var u=w.path();return u.arc(0,0,i,c[0],c[1],d),u.toString()})):"label"===o&&(e=p.append("arc"===o?"path":"text").attr("class","d2b-sunburst-".concat(o," ").concat(d)).style("fill",function(t){return.5<k.hsl(t.color).l?"#000":"#fff"}).each(function(){N.select(this).append("textPath").text(function(t){return t.depth>=t.selected.depth?b.label(t.data):""}).attr("startOffset","50%").attr("xlink:href",function(t){return"#".concat(d,"-hiddenArc").concat(t._id,"-").concat(b._id)}).style("display",function(t){return h.call(this,t)?null:"none"})})),p.append("g").attr("class","d2b-sunburst-".concat(o,"-children ").concat(d)),"arc"===o&&e.style("fill",function(t){return t.color});var f=u.exit();(u=u.merge(p)).select(".d2b-sunburst-".concat(o,".").concat(d)).classed("d2b-sunburst-ancestor",function(t){return t.depth<t.selected.depth}),c.transition&&("arc"===o?(f.each(function(t,n){var e=m(n,a,s);N.select(this).selectAll(".d2b-sunburst-".concat(o)).datum(function(t){var n=c.radii(t.depth);return t.innerRadius=n.inner,t.outerRadius=n.outer,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.centerAngle=e.centerAngle,t.rotate=g(t.centerAngle),t.labelOffset=x(t.centerAngle,n),t}).transition(c.transition).call(r,b.arc)}),f=f.transition(c.transition),u=u.transition(c.transition).on("end",function(){N.select(this).selectAll(".d2b-hidden-arc").attr("id",function(t){return"".concat(d,"-hiddenArc").concat(t._id,"-").concat(b._id)}).attr("d",function(){var t=N.select(this.parentNode).datum(),n=t.innerRadius,e=t.outerRadius,r=t.startAngle,a=t.endAngle,o=Math.PI/2,i=(n+e)/2,c=[r-o,a-o],l=(c[1]+c[0])/2,d=0<l&&l<Math.PI;d&&c.reverse();var u=w.path();return u.arc(0,0,i,c[0],c[1],d),u.toString()})})):"label"===o&&(f.each(function(){N.select(this).selectAll(".d2b-sunburst-".concat(o)).style("opacity",0)}),u=u.transition(c.transition).on("end",function(){N.select(this).selectAll("textPath").text(function(t){return t.depth>=t.selected.depth?b.label(t.data):""}).attr("startOffset","50%").attr("xlink:href",function(t){return"#".concat(d,"-hiddenArc").concat(t._id,"-").concat(b._id)}).style("display",function(t){return h.call(this,t)?null:"none"})}))),f.remove(),"arc"===o&&u.select(".d2b-sunburst-".concat(o,".").concat(d)).call(r,b.arc).style("fill",function(t){return t.color}),u.select(".d2b-sunburst-".concat(o,"-children.").concat(d)).each(function(t){var n=t.children||[],e=R.sum(n,function(t){return t.value}),r=t.startAngle+(t.endAngle-t.startAngle)*e/t.value;v.call(this,n,o,i+1,t.startAngle,r,c)})}function m(t,n,e){var r=function(t,n,e){var r=n.length;for(;0<=--t;)for(var a=e[t].key,o=0;o<r;++o)if(n[o].key===a)return n[o]}(t,n,e),a=function(t,n,e){var r=e.length,a=n.length;for(;++t<r;)for(var o=e[t].key,i=0;i<a;++i)if(n[i].key===o)return n[i]}(t,n,e);return r?{startAngle:r.endAngle,endAngle:r.endAngle}:a?{startAngle:a.startAngle,endAngle:a.startAngle}:{startAngle:0,endAngle:0,centerAngle:0}}return T(t,b).addProp("arc",s.arc()).addProp("pie",s.pie().sort(null)).addProp("ancestorBanding",P.scaleLinear()).addProp("descendantBanding",P.scalePow().exponent(.85)).addPropFunctor("duration",250).addPropFunctor("innerRadius",30).addPropFunctor("outerRadius",200).addPropFunctor("ancestorPadding",10).addPropFunctor("ancestorRatio",.2).addPropFunctor("descendantLevels",1/0).addPropFunctor("startAngle",0).addPropFunctor("endAngle",2*Math.PI).addPropFunctor("showLabels",!1).addPropFunctor("zoomable",!0).addPropFunctor("highlight",!0).addPropFunctor("root",function(t){return t}).addPropFunctor("key",function(t){return b.label(t)}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return j(b.label(t))}).addPropFunctor("children",function(t){return t.children}).addPropFunctor("size",function(t){return t.size}),t}function st(){var B={},t=function t(R){var T=R.selection?R.selection():R;return T.each(function(t){var n=R===T?null:R,e=N.select(this),r=B.size(t),a=G.sankeyLinkHorizontal(),o=B.nodes(t).map(function(t,n){var e=B.nodeKey(t,n);return{key:e,label:B.nodeLabel(t,n,e),color:B.nodeColor(t,n,e),draggableX:B.nodeDraggableX(t,n),draggableY:B.nodeDraggableY(t,n),preserveDragging:B.nodePreserveDragging(t,n),wrapLength:B.nodeLabelWrapLength(t,n),data:t,index:n}}),i=B.links(t).map(function(t,n){var e=B.linkSource(t,n),r=B.linkTarget(t,n);"object"!==J(e)&&(e=o.find(function(t){return t.key===e})),"object"!==J(r)&&(r=o.find(function(t){return t.key===r}));var a=B.linkKey(t,n,e.key,r.key);return{sourceKey:e.key,targetKey:r.key,key:a,keyTrim:a.replace(/ /g,""),sourceColor:B.linkSourceColor(t,n,e.color),targetColor:B.linkTargetColor(t,n,r.color),value:B.linkValue(t,n),source:e,target:r,data:t,index:n}});B.sankey.size([r.width,r.height]).nodeId(function(t){return t.key}).nodes(o).links(i);var c=B.sankey.nodeWidth(),l=B.sankey.nodes(o).links(i)();l.links=l.links.filter(function(t){return!!t.value}),l.nodes=l.nodes.filter(function(t){return!!t.value}),l=B.sankey.nodes(l.nodes).links(l.links)();var d=e.selectAll(".d2b-sankey-link-defs").data([l.links]),u=d.enter().append("defs").attr("class","d2b-sankey-link-defs"),s=(d=d.merge(u)).selectAll(".d2b-def-gradient").data(function(t){return t},function(t){return t.keyTrim}),p=s.enter().append("linearGradient").attr("class","d2b-def-gradient"),f=s.exit();p.append("stop").attr("class","d2b-gradient-from").attr("offset","0%"),p.append("stop").attr("class","d2b-gradient-to").attr("offset","100%"),s=s.merge(p),n&&(f=f.transition(n),s=s.transition(n)),f.remove(),s.attr("id",function(t){return t.keyTrim}),s.select(".d2b-gradient-from").attr("stop-color",function(t){return t.sourceColor}),s.select(".d2b-gradient-to").attr("stop-color",function(t){return t.targetColor});var b=e.selectAll(".d2b-sankey-links").data([l.links]),h=b.enter().append("g").attr("class","d2b-sankey-links"),y=(b=b.merge(h)).selectAll(".d2b-sankey-link").data(function(t){return t},function(t){return t.key}),g=y.enter().append("g").attr("class","d2b-sankey-link"),x=y.exit(),v=y=y.merge(g);n&&(y=y.transition(n),x=x.transition(n));var m=e.selectAll(".d2b-sankey-nodes").data([l.nodes]),k=m.enter().append("g").attr("class","d2b-sankey-nodes"),P=(m=m.merge(k)).selectAll(".d2b-sankey-node").data(function(t){return t},function(t){return t.key}),w=P.enter().append("g").attr("class","d2b-sankey-node"),F=P.exit(),A=P=P.merge(w);function _(t){return M(t)?c+5:-5}function M(t){return t.x0<r.width/2}function z(t){return 5+Math.max(0,t.y1-t.y0)/2}function E(t){if(t.draggableX&&(t.x0=Math.max(0,Math.min(r.width-c,t.x0+N.event.dx)),t.x1=t.x0+c,this.__dragX0=t.x0/r.width),t.draggableY){var n=t.y1-t.y0;t.y0=Math.max(0,Math.min(r.height-(t.y1-t.y0),t.y0+N.event.dy)),t.y1=t.y0+n,this.__dragY0=t.y0/r.height}B.sankey.update(l),C(),T.dispatch("chart-updated",{bubbles:!0})}function C(){var o=0<arguments.length&&void 0!==arguments[0]&&arguments[0];A.select("text").classed("d2b-text-anchor-end",function(t){return!M(t)}).call(O,function(t){return t.label},function(t){return t.wrapLength},"middle");var t=o?y:v,n=o?P:A;t.style("opacity",1).select("path").attr("d",a).style("stroke",function(t){return"url(#".concat(t.keyTrim,")")}).style("stroke-width",function(t){return"".concat(t.width,"px")}),t.each(function(t){var n=N.select(this);if(Math.abs(t.y1-t.y0)<1e-5){var e=n.selectAll("rect").data([t]),r=e.enter().append("rect"),a=t.target.x0-t.source.x1;e=e.merge(r),o&&(e=e.transition(o)),e.attr("x",t.source.x1+Math.min(0,a)).attr("y",t.y0-t.width/2).attr("height",Math.max(0,t.width)).attr("width",Math.abs(t.target.x0-t.source.x1)).style("fill","url(#".concat(t.keyTrim,")")),n.select("path").style("display","none")}else n.select("rect").remove(),n.select("path").style("display","")}),n.attr("transform",function(t){return"translate(".concat(t.x0,", ").concat(t.y0,")")}).style("opacity",1),n.select("rect").attr("width",Math.max(0,c)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}).style("fill",function(t){return t.color}),n.select("text").attr("x",_).attr("y",z)}n&&(P=P.transition(n),F=F.transition(n)),P.each(function(t){if(t.draggableX||t.draggableY?N.select(this).classed("d2b-draggable",!0).call(L.drag().on("drag",E)):N.select(this).classed("d2b-draggable",!1).on(".drag",null),t.preserveDragging&&(void 0!==this.__dragX0&&(t.x0=this.__dragX0*r.width,t.x1=t.x0+c),void 0!==this.__dragY0)){var n=t.y1-t.y0;t.y0=this.__dragY0*r.height,t.y1=t.y0+n}}),B.sankey.update(l),g.style("opacity",0).append("path").attr("d",a).style("stroke",function(t){return"url(#".concat(t.keyTrim,")")}).style("stroke-width",function(t){return"".concat(t.width,"px")}),x.style("opacity",0).remove(),w.attr("transform",function(t){return"translate(".concat(t.x0,", ").concat(t.y0,")")}).style("opacity",0),w.append("rect").attr("width",Math.max(0,c)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}),w.append("text").attr("x",_).attr("y",z),F.style("opacity",0).remove(),C(n)}),T.dispatch("svg-sankey-updated",{bubbles:!0}),t};return T(t,B).addProp("sankey",G.sankey()).addPropFunctor("size",{width:960,height:500}).addPropFunctor("nodes",function(t){return t.nodes}).addPropFunctor("nodeKey",function(t){return t.name}).addPropFunctor("nodeLabel",function(t,n,e){return e}).addPropFunctor("nodeLabelWrapLength",1/0).addPropFunctor("nodeDraggableX",!1).addPropFunctor("nodeDraggableY",!1).addPropFunctor("nodePreserveDragging",!0).addPropFunctor("nodeColor",function(t,n,e){return j(e)}).addPropFunctor("links",function(t){return t.links}).addPropFunctor("linkSource",function(t){return t.source}).addPropFunctor("linkSourceColor",function(t,n,e){return e}).addPropFunctor("linkTarget",function(t){return t.target}).addPropFunctor("linkTargetColor",function(t,n,e){return e}).addPropFunctor("linkKey",function(t,n,e,r){return"".concat(e,"-").concat(r)}).addPropFunctor("linkValue",function(t){return t.value}),t}function pt(){var v={},m=5,t=function t(g){var x=g.selection?g.selection():g;return x.each(function(t,n){var e=v.size.call(this,t,n)||{width:960,height:500},r=function(t){return A(t||0)}(v.margin.call(this,t,n)),a=v.x.call(this,t,n),o=v.x2.call(this,t,n),i=v.y.call(this,t,n),c=v.y2.call(this,t,n),l=N.select(this),d={x:{type:"x",data:a},x2:{type:"x2",data:o},y:{type:"y",data:i},y2:{type:"y2",data:c}},u=A(v.padding.call(this,t,n)),s=l.selectAll(".d2b-plane").data([t]),p=s.enter().append("g").attr("class","d2b-plane"),f=s.merge(p),b=this.__clipID=this.__clipID||"d2b-clip-plane-".concat(D());p.append("defs").append("clipPath").attr("id",b).attr("class","d2b-clip-plane").append("rect");var h=g!==x?g:null;k(d.x,n,f,e.width,h),k(d.x2,n,f,e.width,h),k(d.y,n,f,e.height,h),k(d.y2,n,f,e.height,h),u||(u=function(t){var n={top:0,left:0,right:0,bottom:0};t.x.data&&("outer"===t.x.info.orient&&(n.bottom+=t.x.info.axisBox.height),"outer"===t.x.info.labelOrient1&&(n.bottom+=t.x.info.labelBox.height+m));t.x2.data&&("outer"===t.x2.info.orient&&(n.top+=t.x2.info.axisBox.height),"outer"===t.x2.info.labelOrient1&&(n.top+=t.x2.info.labelBox.height));t.y.data&&("outer"===t.y.info.orient&&(n.left+=t.y.info.axisBox.width),"outer"===t.y.info.labelOrient1&&(n.left+=t.y.info.labelBox.height));t.y2.data&&("outer"===t.y2.info.orient&&(n.right+=t.y2.info.axisBox.width),"outer"===t.y2.info.labelOrient1&&(n.right+=t.y2.info.labelBox.height+m));return n.top=Math.max(n.top,10),n.bottom=Math.max(n.bottom,10),n.left=Math.max(n.left,10),n.right=Math.max(n.right,10),n}(d));var y={top:u.top+r.top,bottom:u.bottom+r.bottom,left:u.left+r.left,right:u.right+r.right};y.width=e.width-y.left-y.right,y.height=e.height-y.top-y.bottom,this.__box__=y,h&&(s=s.transition(h)),p.attr("transform","translate(".concat(y.left,", ").concat(y.top,")")),s.attr("transform","translate(".concat(y.left,", ").concat(y.top,")")),P(d.x,y.width,0,y.height),P(d.x2,y.width,0,0),P(d.y,y.height,0,0),P(d.y2,y.height,y.width,0),w(d.x,y.width,y.height),w(d.x2,y.width,y.height),w(d.y,y.height,y.width),w(d.y2,y.height,y.width),F(d.x,y.width),F(d.x2,y.width),F(d.y,-y.height),F(d.y2,-y.height),f.select(".d2b-clip-plane").select("rect").attr("width",y.width+1).attr("height",y.height+1),f.selectAll(".d2b-grid").attr("clip-path","url(#".concat(b,")"))}),x.dispatch("plane-updated",{bubbles:!0}),t};return T(t,v).addPropFunctor("size",function(t){return t.size}).addPropFunctor("padding",null).addPropFunctor("margin",0).addPropFunctor("x",function(t){return t.x}).addPropFunctor("x2",function(t){return t.x2}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("y2",function(t){return t.y2}).addPropFunctor("axis",function(t){return t.axis}).addPropFunctor("orient",function(t){return t.orient||"outer"}).addPropFunctor("wrapLength",function(t){return I(t.wrapLength,1/0)}).addPropFunctor("tickSize",function(t){return I(t.tickSize,6)}).addPropFunctor("showGrid",function(t){return!1!==t.showGrid}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("labelOrient",function(t){return t.labelOrient||"outer middle"}).addMethod("box",function(t){var n=t.node?t.node():t;return n?n.__box__:null}),t;function k(t,n,e,r,a){var o=[],i=[],c=t.data;c&&(function(t,n,e,r,a){if(!t.data)return;var o=t.info={};o.axis=v.axis(n,e),o.orient=v.orient(n,e),o.wrapLength=v.wrapLength(n,e),o.label=I(v.label(n,e),""),o.labelOrient=v.labelOrient(n,e),o.tickSize=v.tickSize(n,e),o.showGrid=v.showGrid(n,e),o.labelOrient1=o.labelOrient.split(" ")[0],o.labelOrient2=o.labelOrient.split(" ")[1],o.wrapAnchor=function(t){if(!t.data)return;switch(t.type){case"x":return"inner"===t.info.orient?"end":"start";case"x2":return"outer"===t.info.orient?"end":"start";case"y":case"y2":return"middle";default:return"start"}}(t),l(t),d(t,a);var i=r.append("g").attr("class","d2b-axis d2b-".concat(t.type,"-axis")).call(o.axis).call(u,t);o.axisBox=i.node().getBBox();var c=i.append("text").attr("class","d2b-axis-label d2b-".concat(t.type,"-label")).text(o.label);o.labelBox=c.node().getBBox(),i.remove()}(t,c,n,e,r),o=[c],t.info.showGrid&&(i=[c])),t.update=e.selectAll(".d2b-".concat(t.type,"-axis")).data(o),t.enter=t.update.enter().append("g").attr("class","d2b-axis d2b-".concat(t.type,"-axis")),t.labelEnter=t.enter.append("text").attr("class","d2b-axis-label"),t.svg=t.enter.merge(t.update),t.label=t.svg.select(".d2b-axis-label"),t.update.exit().remove(),t.gridUpdate=e.selectAll(".d2b-".concat(t.type,"-grid")).data(i),t.gridEnter=t.gridUpdate.enter().append("g").attr("class","d2b-grid d2b-".concat(t.type,"-grid")),t.gridUpdate.exit().remove(),t.grid=t.gridEnter.merge(t.gridUpdate),a&&(t.svg=t.svg.transition(a),t.update=t.update.transition(a),t.grid=t.grid.transition(a),t.gridUpdate=t.gridUpdate.transition(a),t.label=t.label.transition(a))}function P(t,n,e,r){t.data&&(l(t),d(t,n),t.enter.call(t.info.axis).attr("transform","translate(".concat(e,", ").concat(r,")")),t.update.call(t.info.axis).attr("transform","translate(".concat(e,", ").concat(r,")")),t.svg.call(u,t).on("end",function(){t.svg.call(u,t)}))}function w(t,n,e){t.data&&(function(t,n){if(!t.data)return;switch(t.type){case"x":return t.info.axis.tickSize("inner"===t.info.orient?-n:n);case"x2":case"y":return t.info.axis.tickSize("inner"===t.info.orient?n:-n);case"y2":t.info.axis.tickSize("inner"===t.info.orient?-n:n)}}(t,e),d(t,n),t.gridUpdate.call(t.info.axis).selectAll(".tick text").remove(),t.gridEnter.call(t.info.axis).selectAll(".tick text").remove())}function F(t,n){t.data&&(t.labelEnter.text(t.info.label).attr("x",a(t,n)).attr("y",r(t)).attr("text-anchor",e(t)),t.label.text(t.info.label).attr("x",a(t,n)).attr("y",r(t)).attr("text-anchor",e(t)))}function l(t){t.data&&t.info.axis.tickSizeOuter(0).tickSizeInner(t.info.tickSize)}function d(t,n){t.data&&(-1<["y","y2"].indexOf(t.type)?t.info.axis.scale().range([n,0]):t.info.axis.scale().range([0,n]))}function e(t){if(t.data){var n=t.info,e=-1<["y","y2"].indexOf(t.type);return"start"===n.labelOrient2&&e?"end":"end"!==n.labelOrient2||e?"middle"===n.labelOrient2?"middle":"start":"end"}}function r(t){if(t.data){var n=t.info;switch("".concat(t.type," ").concat(n.orient," ").concat(n.labelOrient1)){case"x inner inner":case"x2 outer outer":return-n.axisBox.height-m;case"x inner outer":case"x2 outer inner":return n.labelBox.height+m;case"x outer inner":case"x2 inner outer":case"y inner outer":case"y2 outer inner":return-m;case"x outer outer":case"x2 inner inner":return n.labelBox.height+n.axisBox.height+m;case"y inner inner":case"y2 outer outer":return n.labelBox.height+n.axisBox.width+m;case"y outer inner":case"y2 inner outer":return n.labelBox.height+m;case"y outer outer":case"y2 inner inner":return-n.axisBox.width-m}}}function a(t,n){if(t.data)return"start"===t.info.labelOrient2?0:"middle"===t.info.labelOrient2?n/2:n}function u(t,n){if(n.data){var e=n.info.wrapLength,r=n.info.wrapAnchor;t.selectAll(".tick text").each(function(){var t=N.select(this);-1===I(t.html(),"").indexOf("tspan")&&(this.storeText=t.text()),t.text("")}).call(O,function(){return this.storeText},e,r)}}function A(t){return"number"==typeof t?{top:t,left:t,right:t,bottom:t}:t}}function ft(t,a){var n=a.legend||{},r=a.tooltip||{};t.label(function(t){return t.label}).value(function(t){return t.value}).duration.conditionally(a.duration).donutRatio.conditionally(a.donutRatio).radius.conditionally(a.radius,function(t,n,e){return a.radius(n,e)}).at.conditionally(a.at,function(t,n,e,r){return x(a.at)(n,e,r)}).color.proxy(function(t){return t.color||x(a.color)(t)}).values.proxy(function(t){return Array.isArray(t.values)?t.values:void 0}),t.chartFrame().size.conditionally(a.size).chartPadding.conditionally(a.chartPadding).padding.conditionally(a.padding).legendEnabled.conditionally(n.enabled).legendOrient.conditionally(n.orient),t.legend().vertical.conditionally(n.orient,["right","left"].includes(n.orient)).clickable.conditionally(n.clickable).dblclickable.conditionally(n.dblclickable).allowEmptied.conditionally(n.allowEmptied).icon.proxy(function(t){return t.legendIcon||x(n.icon)(t)}),t.tooltip().followMouse.conditionally(r.followMouse).my.conditionally(r.my).at.conditionally(r.at).html.proxy(function(t){var n=t.data,e=t.__percent__;return void 0!==n.tooltip?n.tooltip:void 0!==r.html?x(r.html)(n,e):void 0});var e=t.pie(),o=e.arc();void 0!==a.cornerRadius&&o.cornerRadius(a.cornerRadius,0);var i=e.pie();return void 0!==a.startAngle&&i.startAngle(a.startAngle),void 0!==a.endAngle&&i.endAngle(a.endAngle),void 0!==a.padAngle&&i.padAngle(a.padAngle),void 0!==a.sort&&i.sort(null===a.sort?null:function(t,n){return a.slice(0).sort(t.data,n.data)}),a}function bt(t,s){var n=s.legend||{},r=s.tooltip||{};return t.duration.conditionally(s.duration).graphColor.proxy(function(t){return t.color||x(s.graphColor)(t)}).groupColor.proxy(function(t){return t.color||x(s.groupColor)(t)}),t.chartFrame().size.conditionally(s.size).chartPadding.conditionally(s.chartPadding).padding.conditionally(s.padding).legendEnabled.conditionally(n.enabled).legendOrient.conditionally(n.orient),t.plane().margin.conditionally(s.planeMargin).padding.conditionally(s.planePadding),t.legend().vertical.conditionally(n.orient,["right","left"].includes(n.orient)).clickable.conditionally(n.clickable).dblclickable.conditionally(n.dblclickable).allowEmptied.conditionally(n.allowEmptied).icon.proxy(function(t){return t.data.legendIcon||x(n.icon)(t.data)}),t.tooltipConfig.proxy(function(t){s.tooltip&&t.trackX.conditionally(r.trackX).trackY.conditionally(r.trackY).threshold.conditionally(r.threshold).title.conditionally(r.title,function(t){return r.title(t.map(function(t){return{value:t.data,graph:t.graph.data}}))})}),t.graphTooltipConfig.proxy(function(e){if(e.tooltip)return function(t){t.row.proxy(function(t){var n=t.data;return x(v(n.tooltip,e.tooltip,r.row))(n,e)})}}),t.setGenerators(function(t){var e=[];return t.generators.forEach(function(n){"function"==typeof n?e.push(n):n.types?n.types.forEach(function(t){e.push(ht(t,n))}):e.push(ht(n.type,n)),e.forEach(function(t){t.pcolor&&t.pcolor.proxy(function(t){return t.color}),t.pcentered&&t.pcentered.proxy(function(t){return v(t.centered,n.centered)}),t.box&&t.box().width.proxy(function(t){return I(t.width,n.width)}),t.symbol&&t.symbol.proxy(function(t){return I(t.symbol,"function"==typeof n?void 0:n.symbol)}),t.psymbol&&t.psymbol.proxy(function(t){return t.symbol}),t.psize&&t.psize.proxy(function(t){return void 0!==t.size||void 0!==n.size?I(t.size,1)*I(n.size,25):void 0}),t.stackBy&&t.stackBy.proxy(function(t){return v(t.stack,"function"==typeof n?void 0:n.stack)})})}),e}),["x","x2","y","y2"].forEach(function(d){var u=s[d]||{};t[d].proxy(function(t,n){if(s[d]){if(!n.length)return{};var e=u.scale||{},r={},a=n.filter(function(t,n,e){return e.indexOf(t)===n}).sort(R.ascending);if(r.orient=u.orient||"outer",void 0!==u.wrapLength&&(r.wrapLength=u.wrapLength),void 0!==u.tickSize&&(r.tickSize=u.tickSize),void 0!==u.showGrid&&(r.showGrid=u.showGrid),void 0!==u.label&&(r.label=u.label),void 0!==u.labelOrient&&(r.labelOrient=u.labelOrient),void 0!==u.linearPadding&&(r.linearPadding=u.linearPadding),"function"==typeof u.axis)r.axis=u.axis;else switch("".concat(d,"-").concat(r.orient)){case"x-outer":r.axis=f.axisBottom();break;case"y-outer":r.axis=f.axisLeft();break;case"x2-outer":r.axis=f.axisTop();break;case"y2-outer":r.axis=f.axisRight();break;case"x-inner":r.axis=f.axisTop();break;case"y-inner":r.axis=f.axisRight();break;case"x2-inner":r.axis=f.axisBottom();break;case"y2-inner":r.axis=f.axisLeft()}void 0!==u.tickPadding&&r.axis.tickPadding(u.tickPadding),void 0!==u.ticks&&r.axis.ticks(u.ticks),void 0!==u.tickFormat&&r.axis.tickFormat(u.tickFormat),void 0!==u.tickValues&&r.axis.tickValues(u.tickValues);var o=[0,1];if("function"==typeof e)r.scale=e;else{var i=e.type;if(!i){var c=a[0];i="String"===c.constructor.name?"band":"Date"===c.constructor.name?"time":"linear"}i=i.toLowerCase();var l=P["scale".concat(i.charAt(0).toUpperCase()+i.slice(1))];switch(r.scale=l(),i){case"band":case"point":o=a;break;default:o=R.extent(a.map(Number))}}return e.domain&&(o=x(e.domain)(a)),void 0!==e.clamp&&r.scale.clamp(e.clamp),void 0!==e.nice&&r.scale.nice(e.nice),void 0!==e.exponent&&r.scale.exponent(e.exponent),void 0!==e.base&&r.scale.base(e.base),void 0!==e.constant&&r.scale.constant(e.constant),e.forceBounds&&(void 0!==e.forceBounds.min&&(o[0]=e.forceBounds.min),void 0!==e.forceBounds.max&&(o[1]=e.forceBounds.max)),r.scale.domain(o),r}})}),s}function ht(t,n){var e=null,r=n.stackOffset,a=n.stackOrder,o=n.curve,i=n.orient,c=n.align,l=function(t){var n=t.stack();void 0!==r&&n.offset(r),void 0!==a&&n.order(a)},d=function(t){void 0!==o&&t.curve(o)},u=function(t){t.orient.conditionally(i)},s=function(t){t.align.conditionally(c)};switch(t){case"bar":u(e=it().padding.conditionally(n.padding).groupPadding.conditionally(n.groupPadding));break;case"line":l(e=rt()),s(e),d(e.line());break;case"area":l(e=at()),d(e.area());break;case"scatter":l(e=ot()),s(e);break;case"bubblePack":(e=dt().tendancy.conditionally(n.tendancy)).point().size.conditionally(n.size,function(t){return n.size*t.size});break;case"boxPlot":(e=lt()).box().valueFormat.conditionally(n.valueFormat),u(e)}return e}function yt(t,r){var a=r.breadcrumbs||{},o=r.tooltip||{};t.outerRadius.conditionally(r.outerRadius,function(t,n,e){return x(r.outerRadius)(n,e)}).innerRadius.conditionally(r.innerRadius,function(t,n,e){return x(r.innerRadius)(n,e)}).color.proxy(function(t){return t.color||x(r.color)(t)}),t.chartFrame().size.conditionally(r.size).padding.conditionally(r.padding).chartPadding.conditionally(r.chartPadding).breadcrumbsEnabled.conditionally(a.enabled).breadcrumbsOrient.conditionally(a.orient),t.breadcrumbs().vertical.conditionally(a.orient,["right","left"].includes(a.orient)).html.proxy(function(t){var n=t.data,e=t.value,r=t.value/t.selected.value;return void 0!==n.breadcrumb?n.breadcrumb:void 0!==a.html?x(a.html)(n,e,r):void 0}),t.tooltip().followMouse.conditionally(o.followMouse).my.conditionally(o.my).at.conditionally(o.at).html.proxy(function(t){var n=t.data,e=t.value,r=t.value/t.selected.value;return void 0!==n.tooltip?n.tooltip:void 0!==o.html?x(o.html)(n,e,r):void 0});var n=t.sunburst().root.proxy(function(t){return t.root}).size.proxy(function(t){return t.size}).duration.conditionally(r.duration).ancestorPadding.conditionally(r.ancestorPadding).ancestorRatio.conditionally(r.ancestorRatio).descendantLevels.conditionally(r.descendantLevels).startAngle.conditionally(r.startAngle).endAngle.conditionally(r.endAngle).showLabels.conditionally(r.showLabels).zoomable.conditionally(r.zoomable).highlight.conditionally(r.highlight).ancestorBanding.conditionally(r.ancestorBandingExponent,P.scalePow().exponent(r.ancestorBandingExponent)).descendantBanding.conditionally(r.descendantBandingExponent,P.scalePow().exponent(r.descendantBandingExponent)),e=n.pie();void 0!==r.padAngle&&e.padAngle(r.padAngle),void 0!==r.sort&&e.sort(null===r.sort?null:function(t,n){return r.sort.slice(0)(t.data,n.data)});var i=n.arc();return void 0!==r.cornerRadius&&i.cornerRadius(r.cornerRadius,0),r}function gt(t,n){var r=n.node||{},a=n.link||{},o=r.tooltip||{},i=a.tooltip||{};t.chartFrame().chartPadding(0).size.conditionally(n.size).padding.conditionally(n.padding),t.nodeTooltip().followMouse.conditionally(o.followMouse).my.conditionally(o.my).at.conditionally(o.at).html.proxy(function(t){var n=t.data,e=t.value;return void 0!==n.tooltip?n.tooltip:void 0!==o.html?x(o.html)(n,e):void 0}),t.linkTooltip().followMouse.conditionally(i.followMouse).my.conditionally(i.my).at.conditionally(i.at).html.proxy(function(t){var n=t.data,e=t.source.data,r=t.target.data;return void 0!==n.tooltip?n.tooltip:void 0!==i.html?x(i.html)(n,e,r):void 0});var e=t.sankey().nodeLabel(function(t){return t.name}).linkValue(function(t){return t.value}).nodeLabelWrapLength.conditionally(r.labelWrapLength).nodeDraggableX.conditionally(r.draggableX).nodeDraggableY.conditionally(r.draggableY).nodeColor.proxy(function(t,n,e){return t.color||x(r.color)(t,e)}).linkSourceColor.proxy(function(t,n,e){return t.sourceColor||x(a.sourceColor)(t,e)}).linkTargetColor.proxy(function(t,n,e){return t.targetColor||x(a.targetColor)(t,e)}).sankey();if(void 0!==r.align){var c="function"==typeof r.align?r.align:G.sankeyJustify;switch(r.align){case"left":c=G.sankeyLeft;break;case"right":c=G.sankeyRight;break;case"center":c=G.sankeyCenter}e.nodeAlign(c)}return void 0!==n.iterations&&e.iterations(n.iterations),void 0!==r.padding&&e.nodePadding(r.padding),void 0!==r.sort&&e.nodeSort(null===r.sort?null:function(t,n){return r.slice(0).sort(t.data,n.data)}),n}return t.box=ct,t.breadcrumbs=h,t.chartAxis=function(){var B={},G=function t(n){n.call(B.chartFrame),B.legend.empty(function(t){return t.data.hidden}).setEmpty(function(t,n,e){return t.data.hidden=e}).html(function(t){return t.label}).key(function(t){return t.label}).color(function(t){return t.color});var e=n.selection?n.selection():n;return e.each(function(t){(function(t,a){var n=N.select(this),e=n.select(".d2b-chart-container"),r=e.node(),o=n.select(".d2b-legend-container"),i=e.node().__size__,c=O(t),l=Y(c),d=B.duration(t),u=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:O(t),e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Y(n),r=e.filter(function(t){return!t.group});return r.forEach(function(t){t.groupType="graph",t.groupGraphs=[t]}),(B.groups(t)||[]).map(function(t){var n={groupType:"group",data:t,label:B.groupLabel(t),color:B.groupColor(t)};return n.groupGraphs=e.filter(function(t){return n.label===t.group}),n.groupGraphs.forEach(function(t){t.color=n.color}),n}).concat(r)}(t,c),s=B.clipPlane(t),p=(B.annotations(t)||[]).slice().map(function(t,n){return{key:B.annotationKey(t,n),xType:B.annotationXType(t)||"x",yType:B.annotationYType(t)||"y",z:B.annotationZ(t)||"front",x:B.annotationX(t),y:B.annotationY(t),x2:B.annotationX2(t),y2:B.annotationY2(t),color:B.annotationColor(t)||"steelblue",data:t}});!function(t){t.forEach(function(n){n.groupGraphs.forEach(function(t){return t.data.hidden=n.data.hidden})})}(u);var f=r.tooltip=r.tooltip||Q().trackX(!0).trackY(!1).threshold(50);f.title(function(t){return"".concat(I(t[0].x,t[0].x1,t[0].median))}).clear(),B.legend.values(u),(a?o.transition(a):W).call(B.legend),o.call(B.legend).on("change",function(){return n.transition().duration(d).call(G)}).selectAll(".d2b-legend-item").on("mouseover",function(t){return function(n,t){var e=t.selectAll(".d2b-graph"),r=t.selectAll(".d2b-axis-annotation");n.groupGraphs.some(function(t){return!t.data.hidden})&&(e.style("opacity",.2).filter(function(t){return n.data===t.data||-1<(n.groupGraphs.map(function(t){return t.data})||[]).indexOf(t.data)}).style("opacity",""),r.style("opacity",.2).filter(function(t){return n.data===t.graph||-1<(n.groupGraphs.map(function(t){return t.data})||[]).indexOf(t.graph)}).style("opacity",""))}(t,e)}).on("mouseout",function(t){return function(t,n){n.selectAll(".d2b-graph").style("opacity",1),n.selectAll(".d2b-axis-annotation").style("opacity",1)}(0,e)}),B.plane.size(i);var b=e.selectAll(".d2b-axis-plane").data([t]),h=b,y=b.enter().append("g").attr("class","d2b-axis-plane");h=b=b.merge(y);var g=e.selectAll(".d2b-axis-wrapper").data([t]),x=g,v=g.enter().append("g").attr("class","d2b-axis-wrapper");v.append("rect").attr("class","d2b-axis-background"),v.append("g").attr("class","d2b-axis-back-annotations"),v.append("g").attr("class","d2b-axis-sets"),v.append("g").attr("class","d2b-axis-front-annotations"),x=g=g.merge(v);var m=g.select(".d2b-axis-back-annotations"),k=g.select(".d2b-axis-front-annotations"),P=g.select(".d2b-axis-sets").selectAll(".d2b-axis-set").data(c,function(t){return t.key}),w=P.enter().append("g").attr("class","d2b-axis-set"),F=P.exit();P=P.merge(w).order(),a&&(F=F.transition(a),x=x.transition(a),h=h.transition(a),m=m.transition(a),k=k.transition(a));var A={x:[],x2:[],y:[],y2:[]};P.each(function(a){var t=N.select(this),n=a.graphs.filter(function(t){return!t.data.hidden}),o=n.map(function(t){return t.data});n.forEach(function(e){p=p.concat(e.annotations.map(function(t,n){return{key:"".concat(a.key,"-").concat(e.key,"-").concat(B.annotationKey(t,n)),xType:a.xType,yType:a.yType,z:B.annotationZ(t)||"front",x:B.annotationX(t),y:B.annotationY(t),x2:B.annotationX2(t),y2:B.annotationY2(t),color:B.annotationColor(t)||e.color,data:t,graph:e.data}}))}),this.genUpdate=t.selectAll(".d2b-graph-generator").data(a.generators.slice().reverse(),function(t){return t.key}),this.genEnter=this.genUpdate.enter().append("g").attr("class","d2b-graph-generator").style("opacity",0),this.genExit=this.genUpdate.exit(),this.gen=this.genUpdate.merge(this.genEnter).order();var i=this.gen.size();this.gen.each(function(t,e){var n=N.select(this),r=t.generator.tooltipGraph(function(t){if(e<i-1)return null;var n=f.graph(D());return X(t,l).tooltipConfig(n),n}).color(function(t){return X(t,l).color}).graphs(o).getVisiblePoints(n);t.generator.duration&&t.generator.duration(d),r.forEach(function(t){A[a.xType].push(t.x),A[a.yType].push(t.y)})})});var _=B.x(t,A.x),M=B.y(t,A.y),z=B.x2(t,A.x2),E=B.y2(t,A.y2);S(_,A.x,L.x),S(M,A.y,L.y),S(z,A.x2,L.x2),S(E,A.y2,L.y2),B.plane.axis(function(t){return t.__axis__}).x(_.__axis__&&A.x.length?_:null).y(M.__axis__&&A.y.length?M:null).x2(z.__axis__&&A.x2.length?z:null).y2(E.__axis__&&A.y2.length?E:null),y.call(B.plane),h.call(B.plane);var C=B.plane.box(b),R="url(#".concat(b.select(".d2b-clip-plane").attr("id"),")");if(g.attr("clip-path",s?R:""),P.each(function(t){var e="x2"===t.xType?z.__axis__:_.__axis__,r="y2"===t.yType?E.__axis__:M.__axis__;a&&(this.genUpdate=this.genUpdate.transition(a),this.genExit=this.genExit.transition(a).style("opacity",0)),this.genExit.remove(),this.gen.each(function(t){var n=N.select(this);a&&(n=n.transition(a)),t.generator.x(e.scale()).y(r.scale()),n.style("opacity",1).call(t.generator)}),N.select(this).on("change",function(){return n.transition().duration(d).call(G)})}),F.style("opacity",0).remove(),v.attr("transform","translate(".concat(C.left,", ").concat(C.top,")")).select("rect.d2b-axis-background").attr("height",Math.max(0,C.height)).attr("width",Math.max(0,C.width)),x.attr("transform","translate(".concat(C.left,", ").concat(C.top,")")).select("rect.d2b-axis-background").attr("height",Math.max(0,C.height)).attr("width",Math.max(0,C.width)),B.annotation){var T={x:_.__scale__,y:M.__scale__,x2:z.__scale__,y2:E.__scale__};m.call(et,B.annotation,p.filter(function(t){return"back"===t.z}),T),k.call(et,B.annotation,p.filter(function(t){return"front"===t.z}),T)}f.row(function(t){var n=X(t.graph.data,l).label;return"".concat(n,": ").concat(I(t.y,t.y1,t.median))}),B.tooltipConfig(f),f.svgContainer(g).tracker(g).size(C)}).call(this,t,n!==e?n:null)}),e.dispatch("chart-axis-updated",{bubbles:!0}),e.dispatch("chart-updated",{bubbles:!0}),t};T(G,B).addAdvancedConfig(bt).addProp("plane",pt()).addProp("annotation",o.annotation?o.annotation():null).addProp("chartFrame",M().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",W().clickable(!0).dblclickable(!0)).addPropFunctor("tooltipConfig",function(t){return t.tooltipConfig}).addPropFunctor("duration",250).addPropFunctor("x",{}).addPropFunctor("y",{}).addPropFunctor("x2",{}).addPropFunctor("y2",{}).addPropFunctor("clipPlane",!0).addPropFunctor("annotations",function(t){return t.annotations}).addPropFunctor("groups",function(t){return t.groups}).addPropFunctor("sets",function(t){return t.sets}).addPropFunctor("groupLabel",function(t){return t.label}).addPropFunctor("groupColor",function(t){return j(B.groupLabel(t))}).addPropFunctor("setKey",function(t,n){return n}).addPropFunctor("setGenerators",function(t){return t.generators}).addPropFunctor("setXType",function(t){return t.xType}).addPropFunctor("setYType",function(t){return t.yType}).addPropFunctor("setGraphs",function(t){return t.graphs}).addPropFunctor("graphKey",function(t){return t.label}).addPropFunctor("graphLabel",function(t){return t.label}).addPropFunctor("graphGroup",function(t){return t.group}).addPropFunctor("graphColor",function(t){return j(B.graphLabel(t))}).addPropFunctor("graphTooltipConfig",function(t){return t.tooltipConfig}).addPropFunctor("graphAnnotations",function(t){return t.annotations}).addPropFunctor("annotationKey",function(t,n){return n}).addPropFunctor("annotationXType",function(t){return t.xType}).addPropFunctor("annotationYType",function(t){return t.yType}).addPropFunctor("annotationZ",function(t){return t.z}).addPropFunctor("annotationX",function(t){return t.x}).addPropFunctor("annotationY",function(t){return t.y}).addPropFunctor("annotationX2",function(t){return t.x2}).addPropFunctor("annotationY2",function(t){return t.y2}).addPropFunctor("annotationColor",function(t){return t.color});var t=P.scaleBand(),n=P.scaleLinear(),L={x:{band:t.copy(),linear:n.copy(),axis:f.axisBottom()},y:{band:t.copy(),linear:n.copy(),axis:f.axisLeft()},x2:{band:t.copy(),linear:n.copy(),axis:f.axisTop()},y2:{band:t.copy(),linear:n.copy(),axis:f.axisRight()}};function O(t){return B.sets(t).map(function(t,n){var r={};return{data:t,key:B.setKey(t,n),xType:B.setXType(t)||"x",yType:B.setYType(t)||"y",generators:B.setGenerators(t).map(function(t,n){var e=t.type();return 0!==n&&(t.pannotation||t.pannotations||function(){})(null),t.annotation(B.annotation).key(B.graphKey),r[e]=r[e]||0,{data:t,key:"".concat(e,"-").concat(r[e]+=1),generator:t}}),graphs:function(t){return B.setGraphs(t).map(function(t,n){return{data:t,label:B.graphLabel(t)||"",key:B.graphKey(t,n),color:B.graphColor(t),group:B.graphGroup(t),annotations:B.graphAnnotations(t)||[],tooltipConfig:B.graphTooltipConfig(t)||function(){}}})}(t)}})}function Y(t){return[].concat.apply([],t.map(function(t){return t.graphs}))}function X(n,t){return t.filter(function(t){return t.data===n||t.data===n.data})[0]}function S(t,n,e){n.length||(t.hidden=!0);var r=t.axis||e.axis,a=t.scale?t.scale.copy():function(t,n){var e=t.some(function(t){return isNaN(t)}),r=e?u.set(t).values():R.extent(t).map(function(t){return t||0});return(e?n.band:n.linear).domain(r)}(n,e),o=a.domain();if(!a.bandwidth&&t.linearPadding){var i=o[1]-o[0];o[0]=o[0]+i*t.linearPadding[0],o[1]=o[1]+i*t.linearPadding[1]}a.domain(o),t.__axis__=r.scale(a),t.__scale__=a}return G},t.chartFrame=M,t.chartPie=function(){var y={},g=function t(n){n.call(y.chartFrame),y.pie.value(y.value).color(y.color).key(y.key),y.legend.html(y.label).key(y.key).color(y.color),y.tooltip.color(function(t){return k.rgb(y.color(t.data)).darker(.3)});var e=n.selection?n.selection():n;return e.each(function(t){(function(t,r){var n=N.select(this),e=n.select(".d2b-chart-container"),a=e.node().__size__,o=y.radius(t,a.width,a.height),i=y.donutRatio(t),c=y.legend.empty(),l=y.values(t),d=l.filter(function(t){return!c(t)});y.pie.values(d),y.legend.values(l);var u=n.select(".d2b-legend-container");(r?u.transition(r):u).call(y.legend),u.on("change",function(){return n.transition().duration(y.duration(t)).call(g)}).selectAll(".d2b-legend-item").on("mouseover",function(t){v.call(this,n,t,1.03)}).on("mouseout",function(t){v.call(this,n,t)});var s=R.sum(d,function(t){return y.value(t)}),p=e.selectAll(".d2b-pie-chart").data([d]),f=p.enter().append("g").attr("class","d2b-pie-chart");p=p.merge(f),r&&(p=p.transition(r)),y.pie.arc().innerRadius(o*i).outerRadius(o),p.call(y.pie);var b=e.selectAll(".d2b-pie-arc").each(function(t){t.__innerRadius__=o*i,t.__outerRadius__=o,t.__percent__=t.value/s}).on("mouseover",function(t){v.call(this,n,t.data,1.03)}).on("mouseout",function(t){v.call(this,n,t.data)}).call(y.tooltip);b.selectAll(".d2b-pie-arc-percent").data(function(t){return[t]}).enter().append("g").attr("class","d2b-pie-arc-percent").append("text").attr("y",6),b.each(function(){var t=N.select(this),n=t.select(".d2b-pie-arc path").node().current,e=t.select(".d2b-pie-arc-percent"),r=e.select("text").node();e.node().current=n,r.current=r.current||0}),r&&(b=b.each(function(t){t.transitioning=!0}).transition(r).on("end",function(t){t.transitioning=!1})),b.select(".d2b-pie-arc-percent").call(_,y.pie.arc()).select("text").each(function(t){var n=y.arcLabel(t.data),e=N.select(this);r&&(e=e.transition(r)),n?e.text(n):e.call(m,y.value(t.data)/s,x).style("opacity",function(t){return y.showPercent.call(this,t.data,s)?1:0})});var h=function(t,n,e){var r=y.at(t,e.width,e.height,n);if("object"!==J(r)){var a={x:(r=r.split(" "))[1],y:r[0]};switch(r={},a.x){case"left":r.x=n;break;case"center":case"middle":r.x=e.width/2;break;case"right":default:r.x=e.width-n}switch(a.y){case"bottom":r.y=e.height-n;break;case"center":case"middle":r.y=e.height/2;break;case"top":default:r.y=n}}return r}(t,o,a);isNaN(h.x)||isNaN(h.y)||(f.attr("transform","translate(".concat(h.x,", ").concat(h.y,")")),p.attr("transform","translate(".concat(h.x,", ").concat(h.y,")")))}).call(this,t,n!==e?n:null)}),e.dispatch("chart-pie-updated",{bubbles:!0}),e.dispatch("chart-updated",{bubbles:!0}),t},x=a.format(".0%");function v(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,r=y.pie.arc(),a=!1,o=t.selectAll(".d2b-pie-arc").filter(function(t){return t.data===n}).each(function(t){a=a||t.transitioning,t.outerRadius=t.__outerRadius__*e,t.innerRadius=t.__innerRadius__});a||o.select("path").transition().duration(100).call(A,r)}return T(g,y).addProp("chartFrame",M().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",W().clickable(!0).dblclickable(!0)).addProp("key",function(t){return t.label}).addProp("pie",Z()).addProp("tooltip",b().followMouse(!0).html(function(t){return"<b>".concat(y.label(t.data),"</b>: ").concat(y.value(t.data)," (").concat(x(t.__percent__),")")})).addPropFunctor("values",function(t){return t}).addPropFunctor("duration",250).addPropFunctor("donutRatio",0).addPropFunctor("at","center center").addPropFunctor("showPercent",function(t,n){return.03<y.value(t)/n}).addPropFunctor("radius",function(t,n,e){return Math.min(n,e)/2}).addPropFunctor("color",function(t){return j(t.label)}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("arcLabel",null).addPropFunctor("label",function(t){return t.label}).addAdvancedConfig(ft),g},t.chartSankey=function(){var i={};function c(n){n.call(i.chartFrame);var e=n.selection?n.selection():n;return e.each(function(t){(function(t,n){var e=N.select(this).select(".d2b-chart-container"),r=e.node().__size__,a=e.selectAll(".d2b-sankey-chart").data(function(t){return[t]}),o=a.enter().append("g").attr("class","d2b-sankey-chart");return a=a.merge(o),n&&(a=a.transition(n)),a.call(i.sankey.size(r)),a.selectAll(".d2b-sankey-link").call(i.linkTooltip),a.selectAll(".d2b-sankey-node").call(i.nodeTooltip),c}).call(this,t,n!==e?n:null)}),e.dispatch("chart-sankey-updated",{bubbles:!0}),e.dispatch("chart-updated",{bubbles:!0}),c}var t=b().html(function(t){return"\n          <b>".concat(t.key,"</b>:\n          ").concat(t.value,"\n        ")}).color(function(t){return t.color}).followMouse(!0),n=b().html(function(t){return"\n          <b>".concat(t.source.key,"</b>\n          <i class='fas fa fa-arrow-right d2b-sankey-link-arrow' aria-hidden='true'></i>\n          <b>").concat(t.target.key,"</b>:\n          ").concat(t.value,"\n        ")}).color("#444").followMouse(!0);return T(c,i).addProp("chartFrame",M().legendEnabled(!1).breadcrumbsEnabled(!1)).addProp("sankey",st()).addProp("nodeTooltip",t).addProp("linkTooltip",n).addAdvancedConfig(gt),c},t.chartSunburst=function(){var l={},t=function t(n){n.call(l.chartFrame),l.sunburst.label(l.label).color(l.color),l.breadcrumbs.color(function(t){return l.color(t.data)}).key(function(t,n){return n}),l.tooltip.color(function(t){return l.color(t.data)});var e=n.selection?n.selection():n;return e.each(function(t){(function(t,n){var e=N.select(this),r=e.select(".d2b-chart-container"),a=r.node().__size__,o="translate(".concat(a.width/2,", ").concat(a.height/2,")"),i=r.selectAll(".d2b-sunburst-chart").data(function(t){return[t]}),c=i.enter().append("g").attr("transform",o).attr("class","d2b-sunburst-chart");i=i.merge(c),n&&(i=i.transition(n)),l.sunburst.outerRadius(l.outerRadius(t,a.width,a.height)).innerRadius(l.innerRadius(t,a.width,a.height)),i.attr("transform",o).call(l.sunburst),function t(e){var n=e.select(".d2b-sunburst-chart"),r=e.selectAll(".d2b-sunburst-arc.d2b-sunburst-level-0").datum(),a=r.selected;d(e,[a]),n.selectAll(".d2b-sunburst-arc").call(l.tooltip.clear).call(l.tooltip).on("mouseover.breadcrumbs",function(t){var n=t.ancestors();n=n.slice(0,n.indexOf(a)+1),d(e,n.reverse())}).on("mouseout.breadcrumbs",function(){return d(e,[a])}),n.on("mouseout",function(){return t(e)}).on("click",function(){return t(e)})}(e)}).call(this,t,n!==e?n:null)}),e.dispatch("chart-sunburst-updated",{bubbles:!0}),e.dispatch("chart-updated",{bubbles:!0}),t};T(t,l).addProp("chartFrame",M().legendEnabled(!1).breadcrumbsEnabled(!0)).addProp("sunburst",ut()).addProp("breadcrumbs",h().html(function(t){return"<div class = 'd2b-sunburst-breadcrumb'>".concat(n(t),"</div>")})).addProp("tooltip",b().followMouse(!0).html(function(t){return"<div class = 'd2b-sunburst-tooltip'>".concat(n(t),"</div>")})).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return j(l.label(t))}).addPropFunctor("outerRadius",function(t,n,e){return Math.min(n,e)/2}).addPropFunctor("innerRadius",function(t,n,e){return Math.min(50,Math.min(n,e)/4)}).addAdvancedConfig(yt);var e=a.format(",.0f"),r=a.format(".1%"),n=function(t){var n=1<t.value/t.selected.value?"":"<div class = 'd2b-sunburst-percent'>\n        ".concat(r(t.value/t.selected.value),"\n      </div>");return"\n      <div class = 'd2b-sunburst-label'>\n        ".concat(l.label(t.data),"\n      </div>\n      <div class = 'd2b-sunburst-value'>\n        ").concat(e(t.value),"\n        ").concat(n,"\n      </div>\n    ")};function d(t,n){t.select(".d2b-breadcrumbs-container").datum(n).transition("sunburst-breadcrumbs").duration(100).call(l.breadcrumbs)}return t},t.color=j,t.defaultColor=j,t.id=D,t.legend=W,t.mean=z,t.median=r,t.midpoint=B,t.mode=E,t.modelBase=T,t.omit=function(t,n){var e={};for(var r in t)"function"!=typeof t[r]&&n.indexOf(r)<0&&(e[r]=t[r]);return e},t.plane=pt,t.point=q,t.range=C,t.stack=d,t.svgArea=at,t.svgBar=it,t.svgBoxPlot=lt,t.svgBubblePack=dt,t.svgLine=rt,t.svgPie=Z,t.svgSankey=st,t.svgScatter=ot,t.svgSunburst=ut,t.symbolMars=K,t.symbolVenus=V,t.textWrap=O,t.textWrapPX=function(t){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;t.each(function(){var t,n=N.select(this),e=n.text().split(/\s+/).reverse(),r=[],a=0,o=parseFloat(n.attr("y"))||0,i=parseFloat(n.attr("dy"))||0,c=n.text(null).append("tspan").attr("x",0).attr("y",o).attr("dy",i+"em");for(t=e.pop();t;)r.push(t),c.text(r.join(" ")),c.node().getComputedTextLength()>l&&(r.pop(),c.text(r.join(" ")),r=[t],c=n.append("tspan").attr("x",0).attr("y",o).attr("dy",1.1*++a+i+"em").text(t)),t=e.pop()})},t.toDegrees=Y,t.toRadians=function(t){return t*(Math.PI/180)},t.tooltip=b,t.tooltipAxis=Q,t.tweenArc=A,t.tweenCentroid=_,t.tweenNumber=m,t.version="1.0.8",t}({},d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3,d3);
